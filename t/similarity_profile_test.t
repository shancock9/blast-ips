use strict;
use warnings;
use Test;
use Blast::IPS::SimilaritySolution;
use Blast::IPS::AlphaTable qw(alpha_interpolate);

my $rtest_conditions;
my $rtest_profiles;

INIT {

=pod

In this test we compare several wave profiles with reference profiles computed
by the program 'sedov3.f'.  The profiles are at the end of this script.

Reference:
http://www.cococubed.com/code_pages/sedov.shtml

=cut

    my $ntests = @{$rtest_conditions};
    plan tests => $ntests;
}

my $VERBOSE = $ARGV[0];

# Set relative tolerances for radius, pressure, velocity, and density.  
# We can expect a relative accuracy of around 1.e-7 to 1.e-8 in all but the
# radius.  Some of the factors are:
# 1. The alpha values used by 'sedov3.f' have a typical accuracy of about 1.e-7
# to 1.e-8 provided gamma is above about 1.13. Its accuracy falls rapidly for
# lower gamma vaules.
# 2. Some of the reference values are only output to about 8 decimal places so
# we cannot expect much greater accuracy than 1.e-8.
# 3. Some of the reference density values are output with even less accuracy
# because of their wide range.

# On the other hand, the difference in radii is entirely due to the iteration
# tolerance that is used so it can be much tighter.

my $alphatol = 5.e-8;
my $ptol     = $alphatol;
my $utol     = $alphatol;
my $rhotol   = $alphatol;
my $rtol     = 1.e-11;

for ( my $icase = 0 ; $icase < @{$rtest_conditions} ; $icase++ ) {
    my $case = $rtest_conditions->[$icase];
    my ( $symmetry, $gamma, $alpha, $E0, $rho_amb, $time ) = @{$case};

    # Create an object for this condition
    my $similarity_obj = Blast::IPS::SimilaritySolution->new(
        E0       => $E0,
        rho_amb  => $rho_amb,
        gamma    => $gamma,
        symmetry => $symmetry
    );

    # Compare alpha values
    my $alpha_obj = $similarity_obj->get_alpha();
    my $alpha_err = abs( $alpha - $alpha_obj ) / $alpha;

    # Transfer the reference coordinates to an array and get its profile
    my $rxi;
    my $rtest_profile = $rtest_profiles->[$icase];
    foreach my $item ( @{$rtest_profile} ) {
        push @{$rxi}, $item->[0];
    }
    my ($rprofile_norm) = $similarity_obj->get_normalized_profile($rxi);

    # Get the shock front values at time=1
    my $rfront_e = $similarity_obj->shock_front_values( 'T' => $time );

    # Scale the normalized profile for this front
    my $rwave_e = unscale_wave( $rprofile_norm, $rfront_e );

    # Now compare each computed value with the reference value
    my ( $rerr_max, $perr_max, $uerr_max, $rhoerr_max );
    for ( my $i = 0 ; $i < @{$rwave_e} ; $i++ ) {
        my ( $r_e, $p_e, $u_e, $rho_e ) = @{ $rwave_e->[$i] };
        my ( $r_t, $p_t, $u_t, $rho_t ) =
          @{ $rtest_profile->[$i] };
        my $rerr   = abs( $r_e - $r_t ) / $r_t;
        my $perr   = abs( $p_e - $p_t ) / $p_t;
        my $uerr   = abs( $u_e - $u_t ) / $u_t;
        my $rhoerr = abs( $rho_e - $rho_t ) / $rho_t;
        if ( $i == 0 ) {
            $rerr_max   = $rerr;
            $perr_max   = $perr;
            $uerr_max   = $uerr;
            $rhoerr_max = $rhoerr;
        }
        else {
            if ( $rerr > $rerr_max )     { $rerr_max   = $rerr }
            if ( $perr > $perr_max )     { $perr_max   = $perr }
            if ( $uerr > $uerr_max )     { $uerr_max   = $uerr }
            if ( $rhoerr > $rhoerr_max ) { $rhoerr_max = $rhoerr }
        }
    }

    if (
        !ok(
                 $rerr_max < $rtol
              && $perr_max < $ptol
              && $uerr_max < $utol
              && $rhoerr_max < $rhotol
              && $alpha_err < $alphatol
        )
        || $VERBOSE
      )
    {
        print STDERR
"sym=$symmetry\tgamma=$gamma\t$alpha_err\t$rerr_max\t$perr_max\t$uerr_max\t$rhoerr_max\n";
    }
}

sub unscale_wave {
    my ( $rnorm, $rshock ) = @_;
    my ( $rs, $ts, $ps, $ups, $rhos ) = @{$rshock};
    my $rwave;
    foreach my $item ( @{$rnorm} ) {
        my ( $rr, $tt, $pp, $up, $rho ) = @{$item};
        push @{$rwave}, [ $rr, $pp * $ps, $up * $ups, $rho * $rhos ];
    }
    return $rwave;
}

BEGIN {

    # These profiles were computed with the program sedov3.f, obtained at
    # http://www.cococubed.com/code_pages/sedov.shtml

    # For these test profiles, the value of E0 was set equal to the value of
    # the similarity parameter alpha computed by sedov3.f, and the time and
    # ambient densities are 1.

    # The following table format allows for any number of additional cases.
    # Currently we are testing with just three symmetries and two gammas.

    # [symmetry, gamma, $alpha, E0, rho0, time]]
    $rtest_conditions = [
        [ 0, 1.4,   0.53874280,  0.53874280,  1, 1 ],
        [ 1, 1.4,   0.984074056, 0.984074056, 1, 1 ],
        [ 2, 1.4,   0.85107188,  0.85107188,  1, 1 ],
        [ 2, 1.667, 0.493319042, 0.493319042, 1, 1 ],
    ];

    $rtest_profiles = [
        [

            # plane symmetry, gamma=1.4
            # x,pres,vel,den
            [ 0.005, 0.144450266, 0.00238095238, 3.87694418E-06 ],
            [ 0.015, 0.144450266, 0.00714285715, 6.04355789E-05 ],
            [ 0.025, 0.144450273, 0.011904762,   0.00021672778 ],
            [ 0.035, 0.1444503,   0.0166666676,  0.0005026142 ],
            [ 0.045, 0.144450371, 0.0214285751,  0.000942098151 ],
            [ 0.055, 0.144450526, 0.0261904872,  0.00155586559 ],
            [ 0.065, 0.144450819, 0.0309524087,  0.00236237945 ],
            [ 0.075, 0.144451319, 0.0357143466,  0.00337847715 ],
            [ 0.085, 0.144452116, 0.0404763117,  0.00461974102 ],
            [ 0.095, 0.144453317, 0.0452383187,  0.00610074795 ],
            [ 0.105, 0.144455054, 0.0500003874,  0.00783524788 ],
            [ 0.115, 0.144457476, 0.0547625437,  0.0098362976 ],
            [ 0.125, 0.144460759, 0.0595248203,  0.012116365 ],
            [ 0.135, 0.144465102, 0.0642872577,  0.0146874128 ],
            [ 0.145, 0.14447073,  0.0690499055,  0.0175609685 ],
            [ 0.155, 0.144477894, 0.0738128235,  0.0207481833 ],
            [ 0.165, 0.144486872, 0.0785760823,  0.0242598846 ],
            [ 0.175, 0.144497972, 0.0833397654,  0.0281066221 ],
            [ 0.185, 0.14451153,  0.0881039694,  0.0322987109 ],
            [ 0.195, 0.144527913, 0.0928688062,  0.0368462715 ],
            [ 0.205, 0.14454752,  0.0976344035,  0.0417592683 ],
            [ 0.215, 0.14457078,  0.102400907,   0.0470475466 ],
            [ 0.225, 0.144598159, 0.10716848,    0.0527208702 ],
            [ 0.235, 0.144630153, 0.111937307,   0.0587889576 ],
            [ 0.245, 0.144667297, 0.116707594,   0.0652615201 ],
            [ 0.255, 0.144710162, 0.12147957,    0.0721483001 ],
            [ 0.265, 0.144759353, 0.126253489,   0.0794591106 ],
            [ 0.275, 0.144815519, 0.13102963,    0.0872038764 ],
            [ 0.285, 0.144879344, 0.1358083,     0.0953926777 ],
            [ 0.295, 0.144951556, 0.140589836,   0.104035795 ],
            [ 0.305, 0.145032926, 0.145374604,   0.113143755 ],
            [ 0.315, 0.145124267, 0.150163004,   0.122727385 ],
            [ 0.325, 0.145226438, 0.154955469,   0.132797864 ],
            [ 0.335, 0.145340348, 0.159752467,   0.143366776 ],
            [ 0.345, 0.145466951, 0.164554505,   0.154446178 ],
            [ 0.355, 0.145607255, 0.169362127,   0.166048658 ],
            [ 0.365, 0.145762321, 0.174175918,   0.178187405 ],
            [ 0.375, 0.145933265, 0.178996506,   0.190876285 ],
            [ 0.385, 0.146121261, 0.183824563,   0.204129916 ],
            [ 0.395, 0.146327545, 0.188660806,   0.217963755 ],
            [ 0.405, 0.146553416, 0.193505998,   0.232394188 ],
            [ 0.415, 0.146800242, 0.198360953,   0.247438625 ],
            [ 0.425, 0.14706946,  0.203226535,   0.263115607 ],
            [ 0.435, 0.147362584, 0.208103661,   0.279444919 ],
            [ 0.445, 0.147681204, 0.212993301,   0.296447708 ],
            [ 0.455, 0.148026999, 0.21789648,    0.314146618 ],
            [ 0.465, 0.148401734, 0.222814281,   0.332565931 ],
            [ 0.475, 0.148807268, 0.227747845,   0.351731718 ],
            [ 0.485, 0.149245564, 0.232698375,   0.37167201 ],
            [ 0.495, 0.149718691, 0.237667133,   0.392416977 ],
            [ 0.505, 0.150228834, 0.242655445,   0.413999124 ],
            [ 0.515, 0.150778302, 0.247664699,   0.436453507 ],
            [ 0.525, 0.151369535, 0.252696351,   0.459817967 ],
            [ 0.535, 0.152005115, 0.257751922,   0.484133383 ],
            [ 0.545, 0.152687779, 0.262832997,   0.509443956 ],
            [ 0.555, 0.153420425, 0.267941232,   0.535797509 ],
            [ 0.565, 0.154206129, 0.273078348,   0.563245828 ],
            [ 0.575, 0.15504816,  0.278246136,   0.591845026 ],
            [ 0.585, 0.155949989, 0.283446452,   0.621655951 ],
            [ 0.595, 0.156915311, 0.288681221,   0.652744632 ],
            [ 0.605, 0.157948064, 0.293952433,   0.685182765 ],
            [ 0.615, 0.159052441, 0.299262146,   0.719048265 ],
            [ 0.625, 0.160232923, 0.304612478,   0.754425857 ],
            [ 0.635, 0.161494293, 0.31000561,    0.791407743 ],
            [ 0.645, 0.162841667, 0.315443782,   0.830094341 ],
            [ 0.655, 0.164280522, 0.320929289,   0.870595092 ],
            [ 0.665, 0.165816725, 0.326464477,   0.913029375 ],
            [ 0.675, 0.167456571, 0.33205174,    0.957527511 ],
            [ 0.685, 0.169206817, 0.337693513,   1.00423188 ],
            [ 0.695, 0.171074726, 0.343392266,   1.0532982 ],
            [ 0.705, 0.173068112, 0.349150498,   1.10489686 ],
            [ 0.715, 0.175195387, 0.354970726,   1.15921458 ],
            [ 0.725, 0.177465621, 0.360855481,   1.21645606 ],
            [ 0.735, 0.179888599, 0.366807293,   1.27684602 ],
            [ 0.745, 0.182474888, 0.372828684,   1.34063136 ],
            [ 0.755, 0.185235915, 0.378922152,   1.40808364 ],
            [ 0.765, 0.188184042, 0.385090162,   1.4795019 ],
            [ 0.775, 0.191332663, 0.391335128,   1.55521577 ],
            [ 0.785, 0.194696301, 0.397659402,   1.63558904 ],
            [ 0.795, 0.198290722, 0.404065254,   1.7210237 ],
            [ 0.805, 0.202133057, 0.410554858,   1.81196449 ],
            [ 0.815, 0.206241943, 0.417130275,   1.90890411 ],
            [ 0.825, 0.210637678, 0.423793434,   2.01238908 ],
            [ 0.835, 0.215342395, 0.430546116,   2.12302656 ],
            [ 0.845, 0.220380256, 0.437389932,   2.24149199 ],
            [ 0.855, 0.225777678, 0.444326311,   2.36853795 ],
            [ 0.865, 0.231563576, 0.451356481,   2.50500434 ],
            [ 0.875, 0.237769646, 0.458481452,   2.65183006 ],
            [ 0.885, 0.244430688, 0.465702002,   2.81006649 ],
            [ 0.895, 0.251584967, 0.473018664,   2.98089321 ],
            [ 0.905, 0.259274632, 0.480431717,   3.16563611 ],
            [ 0.915, 0.267546188, 0.487941173,   3.36578857 ],
            [ 0.925, 0.276451045, 0.495546776,   3.58303619 ],
            [ 0.935, 0.286046145, 0.503247994,   3.81928577 ],
            [ 0.945, 0.296394692, 0.51104402,    4.07669937 ],
            [ 0.955, 0.307566989, 0.518933775,   4.3577345 ],
            [ 0.965, 0.319641417, 0.526915912,   4.66519165 ],
            [ 0.975, 0.332705575, 0.534988828,   5.00227085 ],
            [ 0.985, 0.346857609, 0.543150671,   5.37263896 ],
            [ 0.995, 0.362207776, 0.551399357,   5.78051039 ],
        ],
        [
            # Cylindrical, gamma=1.4
            # [x,pres,vel,den],
            [ 0.005, 0.0776916002, 0.00178571429, 6.12699529E-12 ],
            [ 0.015, 0.0776916002, 0.00535714286, 1.48885985E-09 ],
            [ 0.025, 0.0776916002, 0.00892857143, 1.91468603E-08 ],
            [ 0.035, 0.0776916002, 0.0125,        1.0297641E-07 ],
            [ 0.045, 0.0776916002, 0.0160714286,  3.61792945E-07 ],
            [ 0.055, 0.0776916003, 0.0196428571,  9.86758719E-07 ],
            [ 0.065, 0.0776916005, 0.0232142857,  2.27491047E-06 ],
            [ 0.075, 0.077691601,  0.0267857144,  4.6526871E-06 ],
            [ 0.085, 0.0776916022, 0.030357143,   8.6994574E-06 ],
            [ 0.095, 0.0776916047, 0.0339285719,  1.51710479E-05 ],
            [ 0.105, 0.0776916092, 0.037500001,   2.50232708E-05 ],
            [ 0.115, 0.0776916173, 0.0410714306,  3.94354529E-05 ],
            [ 0.125, 0.0776916308, 0.0446428611,  5.98339646E-05 ],
            [ 0.135, 0.0776916527, 0.048214293,   8.79157516E-05 ],
            [ 0.145, 0.0776916868, 0.0517857271,  0.000125671869 ],
            [ 0.155, 0.0776917384, 0.0553571647,  0.00017541102 ],
            [ 0.165, 0.0776918143, 0.0589286075,  0.000239783103 ],
            [ 0.175, 0.0776919234, 0.0625000578,  0.000321802768 ],
            [ 0.185, 0.0776920771, 0.0660715187,  0.000424872996 ],
            [ 0.195, 0.0776922896, 0.0696429945,  0.000552808693 ],
            [ 0.205, 0.0776925786, 0.0732144906,  0.000709860331 ],
            [ 0.215, 0.0776929658, 0.0767860142,  0.000900737629 ],
            [ 0.225, 0.0776934775, 0.0803575743,  0.00113063331 ],
            [ 0.235, 0.0776941455, 0.0839291824,  0.00140524693 ],
            [ 0.245, 0.0776950076, 0.0875008528,  0.00173080886 ],
            [ 0.255, 0.0776961089, 0.091072603,   0.0021141044 ],
            [ 0.265, 0.0776975022, 0.0946444548,  0.00256249809 ],
            [ 0.275, 0.0776992494, 0.0982164344,  0.00308395833 ],
            [ 0.285, 0.0777014225, 0.101788574,   0.00368708227 ],
            [ 0.295, 0.0777041046, 0.105360911,   0.00438112117 ],
            [ 0.305, 0.0777073917, 0.108933491,   0.00517600627 ],
            [ 0.315, 0.0777113934, 0.112506368,   0.00608237532 ],
            [ 0.325, 0.0777162348, 0.116079605,   0.00711159987 ],
            [ 0.335, 0.0777220582, 0.119653277,   0.0082758136 ],
            [ 0.345, 0.0777290243, 0.12322747,    0.00958794179 ],
            [ 0.355, 0.0777373146, 0.126802285,   0.0110617323 ],
            [ 0.365, 0.0777471327, 0.130377837,   0.012711788 ],
            [ 0.375, 0.0777587069, 0.133954261,   0.0145536018 ],
            [ 0.385, 0.0777722924, 0.13753171,    0.0166035937 ],
            [ 0.395, 0.077788173,  0.141110359,   0.0188791507 ],
            [ 0.405, 0.0778066645, 0.144690407,   0.0213986703 ],
            [ 0.415, 0.0778281168, 0.148272081,   0.0241816082 ],
            [ 0.425, 0.0778529167, 0.151855638,   0.0272485306 ],
            [ 0.435, 0.0778814914, 0.155441365,   0.0306211715 ],
            [ 0.445, 0.0779143116, 0.159029588,   0.0343224974 ],
            [ 0.455, 0.0779518946, 0.162620671,   0.0383767787 ],
            [ 0.465, 0.0779948088, 0.166215022,   0.04280967 ],
            [ 0.475, 0.078043677,  0.169813096,   0.0476483004 ],
            [ 0.485, 0.0780991814, 0.1734154,     0.0529213757 ],
            [ 0.495, 0.0781620678, 0.177022497,   0.0586592934 ],
            [ 0.505, 0.0782331513, 0.180635011,   0.0648942733 ],
            [ 0.515, 0.0783133213, 0.184253632,   0.0716605065 ],
            [ 0.525, 0.0784035478, 0.187879122,   0.0789943237 ],
            [ 0.535, 0.0785048884, 0.191512322,   0.0869343879 ],
            [ 0.545, 0.0786184947, 0.195154154,   0.0955219137 ],
            [ 0.555, 0.0787456214, 0.198805632,   0.104800918 ],
            [ 0.565, 0.0788876345, 0.202467867,   0.114818506 ],
            [ 0.575, 0.079046021,  0.206142075,   0.125625201 ],
            [ 0.585, 0.0792224003, 0.209829582,   0.137275314 ],
            [ 0.595, 0.0794185362, 0.213531837,   0.149827384 ],
            [ 0.605, 0.0796363504, 0.217250416,   0.163344661 ],
            [ 0.615, 0.0798779378, 0.220987031,   0.177895681 ],
            [ 0.625, 0.0801455836, 0.224743541,   0.193554919 ],
            [ 0.635, 0.0804417829, 0.228521963,   0.210403538 ],
            [ 0.645, 0.0807692626, 0.232324477,   0.228530259 ],
            [ 0.655, 0.081131006,  0.236153439,   0.24803237 ],
            [ 0.665, 0.0815302813, 0.240011392,   0.26901688 ],
            [ 0.675, 0.0819706739, 0.243901074,   0.291601877 ],
            [ 0.685, 0.0824561232, 0.247825432,   0.315918092 ],
            [ 0.695, 0.0829909647, 0.251787629,   0.342110728 ],
            [ 0.705, 0.0835799785, 0.255791056,   0.370341596 ],
            [ 0.715, 0.0842284452, 0.259839343,   0.400791614 ],
            [ 0.725, 0.0849422106, 0.263936368,   0.433663747 ],
            [ 0.735, 0.0857277593, 0.268086264,   0.469186461 ],
            [ 0.745, 0.0865923018, 0.272293429,   0.50761781 ],
            [ 0.755, 0.0875438744, 0.27656253,    0.549250273 ],
            [ 0.765, 0.0885914565, 0.280898508,   0.594416508 ],
            [ 0.775, 0.0897451062, 0.285306579,   0.643496212 ],
            [ 0.785, 0.0910161212, 0.289792233,   0.696924337 ],
            [ 0.795, 0.0924172258, 0.294361224,   0.75520096 ],
            [ 0.805, 0.0939627924, 0.299019565,   0.818903192 ],
            [ 0.815, 0.0956691025, 0.303773505,   0.888699599 ],
            [ 0.825, 0.0975546572, 0.308629511,   0.96536776 ],
            [ 0.835, 0.0996405453, 0.313594229,   1.0498157 ],
            [ 0.845, 0.101950884,  0.318674447,   1.14310824 ],
            [ 0.855, 0.104513347,  0.323877042,   1.24649947 ],
            [ 0.865, 0.107359801,  0.329208916,   1.36147307 ],
            [ 0.875, 0.110527076,  0.33467692,    1.4897926 ],
            [ 0.885, 0.114057903,  0.340287765,   1.63356458 ],
            [ 0.895, 0.118002063,  0.346047921,   1.79531817 ],
            [ 0.905, 0.122417798,  0.351963505,   1.97810644 ],
            [ 0.915, 0.127373562,  0.358040157,   2.18563608 ],
            [ 0.925, 0.132950215,  0.364282908,   2.42243468 ],
            [ 0.935, 0.139243767,  0.370696047,   2.6940684 ],
            [ 0.945, 0.146368875,  0.377282988,   3.00742763 ],
            [ 0.955, 0.154463314,  0.384046143,   3.37110544 ],
            [ 0.965, 0.163693743,  0.390986805,   3.79590408 ],
            [ 0.975, 0.174263245,  0.398105064,   4.29552044 ],
            [ 0.985, 0.186421257,  0.405399729,   4.88748442 ],
            [ 0.995, 0.20047682,   0.412868303,   5.59446033 ],
        ],
        [
            # spherical, gamma=1.4
            # [x,pres,vel,den],
            [ 0.005, 0.0487284104, 0.00142857143, 1.02977672E-17 ],
            [ 0.015, 0.0487284104, 0.00428571429, 3.90078919E-14 ],
            [ 0.025, 0.0487284104, 0.00714285714, 1.7989459E-12 ],
            [ 0.035, 0.0487284104, 0.01,          2.24377017E-11 ],
            [ 0.045, 0.0487284104, 0.0128571429,  1.47761704E-10 ],
            [ 0.055, 0.0487284104, 0.0157142857,  6.65561526E-10 ],
            [ 0.065, 0.0487284104, 0.0185714286,  2.3297977E-09 ],
            [ 0.075, 0.0487284104, 0.0214285714,  6.81439828E-09 ],
            [ 0.085, 0.0487284104, 0.0242857143,  1.74224802E-08 ],
            [ 0.095, 0.0487284104, 0.0271428571,  4.01231552E-08 ],
            [ 0.105, 0.0487284104, 0.03,          8.49939046E-08 ],
            [ 0.115, 0.0487284104, 0.0328571429,  1.68151924E-07 ],
            [ 0.125, 0.0487284105, 0.0357142857,  3.14262916E-07 ],
            [ 0.135, 0.0487284106, 0.0385714286,  5.59720616E-07 ],
            [ 0.145, 0.0487284108, 0.0414285715,  9.56594895E-07 ],
            [ 0.155, 0.0487284112, 0.0442857144,  1.57745065E-06 ],
            [ 0.165, 0.0487284119, 0.0471428575,  2.5211439E-06 ],
            [ 0.175, 0.048728413,  0.0500000006,  3.91970542E-06 ],
            [ 0.185, 0.0487284148, 0.0528571439,  5.94642637E-06 ],
            [ 0.195, 0.0487284176, 0.0557142875,  8.82526381E-06 ],
            [ 0.205, 0.048728422,  0.0585714316,  1.2841688E-05 ],
            [ 0.215, 0.0487284286, 0.0614285764,  1.83550965E-05 ],
            [ 0.225, 0.0487284385, 0.0642857223,  2.58129244E-05 ],
            [ 0.235, 0.0487284528, 0.0671428698,  3.57665818E-05 ],
            [ 0.245, 0.0487284734, 0.0700000197,  4.88893556E-05 ],
            [ 0.255, 0.0487285026, 0.0728571728,  6.59964128E-05 ],
            [ 0.265, 0.0487285433, 0.0757143305,  8.80670493E-05 ],
            [ 0.275, 0.0487285993, 0.0785714947,  0.000116269329 ],
            [ 0.285, 0.0487286756, 0.0814286677,  0.000151987261 ],
            [ 0.295, 0.0487287784, 0.0842858525,  0.000196850674 ],
            [ 0.305, 0.0487289155, 0.0871430533,  0.000252767934 ],
            [ 0.315, 0.0487290967, 0.0900002752,  0.000321961678 ],
            [ 0.325, 0.0487293339, 0.092857525,   0.000407007725 ],
            [ 0.335, 0.048729642,  0.095714811,   0.000510877335 ],
            [ 0.345, 0.0487300391, 0.098572144,   0.000636982997 ],
            [ 0.355, 0.048730547,  0.101429537,   0.000789227935 ],
            [ 0.365, 0.0487311924, 0.104287007,   0.000972059517 ],
            [ 0.375, 0.0487320068, 0.107144574,   0.0011905268 ],
            [ 0.385, 0.0487330284, 0.110002264,   0.00145034241 ],
            [ 0.395, 0.0487343024, 0.112860106,   0.00175794898 ],
            [ 0.405, 0.0487358822, 0.115718138,   0.0021205905 ],
            [ 0.415, 0.0487378309, 0.118576405,   0.00254638876 ],
            [ 0.425, 0.0487402225, 0.121434962,   0.00304442524 ],
            [ 0.435, 0.0487431437, 0.124293872,   0.00362482891 ],
            [ 0.445, 0.0487466956, 0.127153214,   0.00429887021 ],
            [ 0.455, 0.0487509953, 0.130013079,   0.00507906187 ],
            [ 0.465, 0.0487561787, 0.132873576,   0.00597926697 ],
            [ 0.475, 0.0487624027, 0.135734832,   0.00701481506 ],
            [ 0.485, 0.0487698476, 0.138596999,   0.00820262706 ],
            [ 0.495, 0.0487787207, 0.141460253,   0.00956134991 ],
            [ 0.505, 0.048789259,  0.1443248,     0.0111115021 ],
            [ 0.515, 0.0488017334, 0.147190879,   0.0128756316 ],
            [ 0.525, 0.0488164524, 0.150058768,   0.0148784871 ],
            [ 0.535, 0.0488337668, 0.152928789,   0.0171472062 ],
            [ 0.545, 0.0488540746, 0.155801311,   0.0197115206 ],
            [ 0.555, 0.0488778264, 0.158676762,   0.0226039833 ],
            [ 0.565, 0.0489055318, 0.16155563,    0.0258602199 ],
            [ 0.575, 0.0489377659, 0.164438477,   0.0295192086 ],
            [ 0.585, 0.048975177,  0.167325942,   0.0336235945 ],
            [ 0.595, 0.0490184946, 0.170218755,   0.0382200429 ],
            [ 0.605, 0.0490685393, 0.173117743,   0.0433596409 ],
            [ 0.615, 0.0491262329, 0.176023848,   0.049098354 ],
            [ 0.625, 0.04919261,   0.178938135,   0.0554975507 ],
            [ 0.635, 0.0492688317, 0.181861806,   0.0626246067 ],
            [ 0.645, 0.0493561999, 0.184796218,   0.0705536057 ],
            [ 0.655, 0.0494561749, 0.187742899,   0.0793661547 ],
            [ 0.665, 0.049570394,  0.190703565,   0.0891523398 ],
            [ 0.675, 0.0497006941, 0.193680141,   0.10001185 ],
            [ 0.685, 0.049849137,  0.196674781,   0.112055306 ],
            [ 0.695, 0.0500180385, 0.199689895,   0.125405833 ],
            [ 0.705, 0.0502100024, 0.202728172,   0.140200945 ],
            [ 0.715, 0.0504279607, 0.205792605,   0.15659479 ],
            [ 0.725, 0.0506752192, 0.208886527,   0.174760859 ],
            [ 0.735, 0.0509555131, 0.212013637,   0.194895249 ],
            [ 0.745, 0.0512730712, 0.215178036,   0.21722063 ],
            [ 0.755, 0.051632693,  0.218384261,   0.241991072 ],
            [ 0.765, 0.0520398408, 0.221637326,   0.269497956 ],
            [ 0.775, 0.0525007497, 0.224942758,   0.300077251 ],
            [ 0.785, 0.0530225616, 0.22830664,    0.33411851 ],
            [ 0.795, 0.0536134858, 0.231735648,   0.372076056 ],
            [ 0.805, 0.0542829967, 0.235237096,   0.414482976 ],
            [ 0.815, 0.0550420744, 0.23881897,    0.461968725 ],
            [ 0.825, 0.0559035021, 0.242489965,   0.515281425 ],
            [ 0.835, 0.0568822339, 0.246259511,   0.575316285 ],
            [ 0.845, 0.0579958532, 0.250137795,   0.643152115 ],
            [ 0.855, 0.0592651473, 0.25413576,    0.720098564 ],
            [ 0.865, 0.0607148322, 0.258265094,   0.807757751 ],
            [ 0.875, 0.0623744735, 0.262538187,   0.90810537 ],
            [ 0.885, 0.0642796653, 0.26696806,    1.0235984 ],
            [ 0.895, 0.0664735512, 0.271568243,   1.15731956 ],
            [ 0.905, 0.0690088051, 0.276352614,   1.31317317 ],
            [ 0.915, 0.0719502354, 0.281335169,   1.49615364 ],
            [ 0.925, 0.0753782467, 0.286529724,   1.71271827 ],
            [ 0.935, 0.079393496,  0.291949553,   1.97131174 ],
            [ 0.945, 0.0841232411, 0.297606951,   2.28311529 ],
            [ 0.955, 0.0897301231, 0.303512738,   2.66313405 ],
            [ 0.965, 0.0964245182, 0.309675723,   3.13180393 ],
            [ 0.975, 0.104482225,  0.316102168,   3.71741394 ],
            [ 0.985, 0.114270307,  0.322795276,   4.45983933 ],
            [ 0.995, 0.126285684,  0.329754784,   5.41643833 ],
        ],
        [
            # spherical, gamma=1.667
            #[x,pres,vel,den],
            [ 0.005, 0.0367311191, 0.00119976005, 6.13283442E-11 ],
            [ 0.015, 0.0367311191, 0.00359928014, 8.58289697E-09 ],
            [ 0.025, 0.0367311191, 0.00599880024, 8.53993101E-08 ],
            [ 0.035, 0.0367311191, 0.00839832034, 3.8788403E-07 ],
            [ 0.045, 0.0367311191, 0.0107978404,  1.20117576E-06 ],
            [ 0.055, 0.0367311193, 0.0131973606,  2.96200892E-06 ],
            [ 0.065, 0.0367311198, 0.0155968807,  6.27915512E-06 ],
            [ 0.075, 0.0367311209, 0.017996401,   1.19516273E-05 ],
            [ 0.085, 0.0367311233, 0.0203959215,  2.09852575E-05 ],
            [ 0.095, 0.0367311278, 0.0227954424,  3.46080219E-05 ],
            [ 0.105, 0.0367311358, 0.0251949642,  5.42843615E-05 ],
            [ 0.115, 0.0367311494, 0.0275944873,  8.17286757E-05 ],
            [ 0.125, 0.0367311712, 0.0299940129,  0.000118918119 ],
            [ 0.135, 0.036731205,  0.0323935421,  0.000168104801 ],
            [ 0.145, 0.0367312559, 0.0347930769,  0.000231827477 ],
            [ 0.155, 0.0367313301, 0.03719262,    0.00031292278 ],
            [ 0.165, 0.0367314358, 0.039592175,   0.000414536074 ],
            [ 0.175, 0.0367315833, 0.041991747,   0.000540131958 ],
            [ 0.185, 0.0367317852, 0.0443913422,  0.000693504478 ],
            [ 0.195, 0.0367320569, 0.0467909689,  0.000878787087 ],
            [ 0.205, 0.0367324171, 0.0491906378,  0.0011004624 ],
            [ 0.215, 0.0367328879, 0.0515903621,  0.00136337181 ],
            [ 0.225, 0.0367334958, 0.0539901584,  0.0016727249 ],
            [ 0.235, 0.0367342719, 0.0563900471,  0.00203410895 ],
            [ 0.245, 0.0367352525, 0.0587900531,  0.00245349828 ],
            [ 0.255, 0.0367364797, 0.0611902066,  0.00293726372 ],
            [ 0.265, 0.0367380021, 0.0635905438,  0.00349218226 ],
            [ 0.275, 0.0367398754, 0.065991108,   0.00412544678 ],
            [ 0.285, 0.0367421633, 0.0683919502,  0.00484467623 ],
            [ 0.295, 0.0367449381, 0.0707931308,  0.00565792608 ],
            [ 0.305, 0.0367482815, 0.0731947204,  0.00657369946 ],
            [ 0.315, 0.0367522857, 0.0755968012,  0.00760095882 ],
            [ 0.325, 0.036757054,  0.0779994684,  0.00874913852 ],
            [ 0.335, 0.036762702,  0.0804028318,  0.0100281584 ],
            [ 0.345, 0.0367693587, 0.0828070176,  0.0114484386 ],
            [ 0.355, 0.0367771673, 0.0852121701,  0.0130209159 ],
            [ 0.365, 0.0367862865, 0.0876184535,  0.0147570613 ],
            [ 0.375, 0.0367968919, 0.0900260545,  0.0166689006 ],
            [ 0.385, 0.036809177,  0.092435184,   0.0187690365 ],
            [ 0.395, 0.0368233548, 0.0948460799,  0.0210706736 ],
            [ 0.405, 0.0368396591, 0.0972590094,  0.0235876467 ],
            [ 0.415, 0.0368583464, 0.0996742723,  0.0263344533 ],
            [ 0.425, 0.0368796969, 0.102092203,   0.029326289 ],
            [ 0.435, 0.0369040172, 0.104513175,   0.0325790893 ],
            [ 0.445, 0.0369316413, 0.106937603,   0.0361095756 ],
            [ 0.455, 0.0369629333, 0.109365947,   0.0399353087 ],
            [ 0.465, 0.0369982896, 0.111798716,   0.0440747484 ],
            [ 0.475, 0.0370381409, 0.114236471,   0.0485473225 ],
            [ 0.485, 0.0370829551, 0.116679832,   0.0533735039 ],
            [ 0.495, 0.0371332403, 0.119129478,   0.0585748997 ],
            [ 0.505, 0.0371895475, 0.121586158,   0.0641743513 ],
            [ 0.515, 0.0372524747, 0.124050687,   0.0701960488 ],
            [ 0.525, 0.0373226698, 0.126523961,   0.0766656611 ],
            [ 0.535, 0.0374008356, 0.129006954,   0.0836104833 ],
            [ 0.545, 0.0374877339, 0.13150073,    0.0910596052 ],
            [ 0.555, 0.0375841909, 0.134006444,   0.0990441022 ],
            [ 0.565, 0.0376911025, 0.136525351,   0.107597253 ],
            [ 0.575, 0.0378094412, 0.139058812,   0.116754786 ],
            [ 0.585, 0.0379402629, 0.1416083,     0.126555163 ],
            [ 0.595, 0.038084715,  0.144175409,   0.1370399 ],
            [ 0.605, 0.0382440452, 0.146761855,   0.148253932 ],
            [ 0.615, 0.038419612,  0.149369492,   0.160246032 ],
            [ 0.625, 0.0386128957, 0.152000312,   0.17306929 ],
            [ 0.635, 0.0388255117, 0.154656457,   0.18678166 ],
            [ 0.645, 0.0390592247, 0.157340223,   0.201446584 ],
            [ 0.655, 0.039315966,  0.160054072,   0.217133715 ],
            [ 0.665, 0.0395978517, 0.162800632,   0.233919737 ],
            [ 0.675, 0.0399072045, 0.165582713,   0.251889321 ],
            [ 0.685, 0.0402465786, 0.168403305,   0.271136217 ],
            [ 0.695, 0.040618787,  0.171265589,   0.291764521 ],
            [ 0.705, 0.0410269341, 0.174172941,   0.313890139 ],
            [ 0.715, 0.0414744521, 0.177128931,   0.337642482 ],
            [ 0.725, 0.0419651434, 0.180137334,   0.363166441 ],
            [ 0.735, 0.0425032285, 0.183202118,   0.390624677 ],
            [ 0.745, 0.0430934018, 0.186327453,   0.420200302 ],
            [ 0.755, 0.0437408953, 0.189517697,   0.452100005 ],
            [ 0.765, 0.0444515529, 0.192777389,   0.486557715 ],
            [ 0.775, 0.0452319147, 0.196111237,   0.523838906 ],
            [ 0.785, 0.046089316,  0.199524095,   0.564245661 ],
            [ 0.795, 0.0470320011, 0.203020942,   0.608122637 ],
            [ 0.805, 0.0480692553, 0.206606844,   0.655864125 ],
            [ 0.815, 0.0492115587, 0.21028692,    0.707922419 ],
            [ 0.825, 0.050470765,  0.214066293,   0.764817741 ],
            [ 0.835, 0.0518603098, 0.21795003,    0.827150084 ],
            [ 0.845, 0.0533954549, 0.221943077,   0.895613342 ],
            [ 0.855, 0.0550935744, 0.226050187,   0.97101224 ],
            [ 0.865, 0.0569744909, 0.230275837,   1.05428267 ],
            [ 0.875, 0.0590608734, 0.234624133,   1.14651623 ],
            [ 0.885, 0.0613787072, 0.239098721,   1.24898983 ],
            [ 0.895, 0.0639578541, 0.243702689,   1.36320178 ],
            [ 0.905, 0.0668327208, 0.248438467,   1.49091564 ],
            [ 0.915, 0.0700430622, 0.253307741,   1.63421395 ],
            [ 0.925, 0.0736349489, 0.258311371,   1.79556444 ],
            [ 0.935, 0.0776619421, 0.263449322,   1.97790162 ],
            [ 0.945, 0.0821865241, 0.268720621,   2.18472837 ],
            [ 0.955, 0.0872818523, 0.274123325,   2.42024269 ],
            [ 0.965, 0.0930339193, 0.279654531,   2.68949686 ],
            [ 0.975, 0.0995442288, 0.285310396,   2.99859853 ],
            [ 0.985, 0.106933128,  0.291086198,   3.35496626 ],
            [ 0.995, 0.115343981,  0.296976413,   3.76765614 ],
        ],

    ];
}
