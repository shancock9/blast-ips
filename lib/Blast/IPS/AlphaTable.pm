package Blast::IPS::AlphaTable;

# MIT License
# Copyright (c) 2018 Steven Hancock
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.

# This module provides a routine 'alpha_interpolate' which returns an accurate
# value of the similarity parameter alpha for the three symmetries and
# gamma between 1.1 and 7.

use strict;
use warnings;
use 5.006;

our @EXPORT_OK = qw(
  alpha_interpolate
);

use Exporter;
our @ISA = qw(Exporter);

use Carp;
our $ralpha_table;

use Blast::IPS::MathUtils qw(
  polint
  set_interpolation_points
  locate_2d
);

##################################################################
# ALPHA TABLE
##################################################################
BEGIN {

    # This table of values was created by integrating the Von Neumann
    # analytical solution using the script 'alpha_integrate.pl'. The values
    # are in good agreement with values produced by other software and
    # with the values extracted from the finite difference solutions.

    # The table format is:
    # $ralpha_table->[$symmetry]= [gamma, alpha, err];

    # where:
    #   symmetry = 0,1,2 for plane, cylindrical, spherical
    #   err = the estimated integration error in the value of alpha
    #         the table is printed with up to 12 decimal digits
    #         (i.e. uncertainty in value of alpha; not relative error)

    $ralpha_table = [
        [
            [ 1.001, 222.28993466613, 3.02e-11 ],
            [ 1.002, 111.17834923414, 1.04e-11 ],
            [ 1.003, 74.1408406043,   2.16e-10 ],
            [ 1.004, 55.6218531987,   1.58e-10 ],
            [ 1.005, 44.510275884679, 1.64e-12 ],
            [ 1.006, 37.10240493721,  9.46e-12 ],
            [ 1.007, 31.81093874765,  6e-12 ],
            [ 1.008, 27.842226501295, 4.55e-13 ],
            [ 1.009, 24.755351069587, 4.05e-12 ],
            [ 1.01,  22.285762167519, 6.75e-14 ],
            [ 1.02,  11.170257523758, 2.36e-13 ],
            [ 1.03,  7.462397060334,  2.36e-13 ],
            [ 1.04,  5.606607857586,  1.4e-13 ],
            [ 1.05,  4.491763108289,  1.73e-13 ],
            [ 1.06,  3.747478215300,  1.63e-13 ],
            [ 1.07,  3.215010091881,  9.9e-14 ],
            [ 1.08,  2.814981882407,  6.66e-14 ],
            [ 1.09,  2.503291124368,  4.4e-14 ],
            [ 1.1,   2.253472953549,  4.44e-14 ],
            [ 1.11,  2.048683333022,  4.13e-14 ],
            [ 1.12,  1.877690631556,  2.09e-14 ],
            [ 1.13,  1.732717214216,  5.77e-15 ],
            [ 1.14,  1.608206042757,  2.16e-13 ],
            [ 1.15,  1.500080617477,  1.82e-13 ],
            [ 1.16,  1.405282425967,  1.52e-13 ],
            [ 1.17,  1.321471633021,  1.24e-13 ],
            [ 1.18,  1.246827530548,  1.05e-13 ],
            [ 1.19,  1.179911994969,  9.04e-14 ],
            [ 1.2,   1.119573900472,  7.26e-14 ],
            [ 1.21,  1.064880836969,  6.79e-14 ],
            [ 1.22,  1.015069445546,  6e-14 ],
            [ 1.23,  0.969508705766,  5.15e-14 ],
            [ 1.24,  0.927672397650,  4.7e-14 ],
            [ 1.25,  0.889118169795,  3.82e-14 ],
            [ 1.26,  0.853471435395,  3.36e-14 ],
            [ 1.27,  0.820412844721,  3.06e-14 ],
            [ 1.28,  0.789668440199,  2.84e-14 ],
            [ 1.29,  0.761001846735,  2.65e-14 ],
            [ 1.3,   0.734208022570,  2.49e-14 ],
            [ 1.31,  0.709108218419,  1.87e-14 ],
            [ 1.32,  0.685545880708,  1.78e-14 ],
            [ 1.33,  0.663383298737,  1.58e-14 ],
            [ 1.34,  0.642498842709,  2.48e-13 ],
            [ 1.35,  0.622784674521,  2.28e-13 ],
            [ 1.36,  0.604144839455,  2.07e-13 ],
            [ 1.37,  0.586493666769,  1.92e-13 ],
            [ 1.38,  0.569754422335,  1.75e-13 ],
            [ 1.39,  0.553858168121,  1.53e-13 ],
            [ 1.4,   0.538742792368,  1.41e-13 ],
            [ 1.41,  0.524352181345,  1.3e-13 ],
            [ 1.42,  0.510635509121,  1.19e-13 ],
            [ 1.43,  0.497546626155,  1.09e-13 ],
            [ 1.44,  0.485043531025,  1.02e-13 ],
            [ 1.45,  0.473087912366,  9.33e-14 ],
            [ 1.46,  0.461644750361,  8.42e-14 ],
            [ 1.47,  0.450681968926,  7.81e-14 ],
            [ 1.48,  0.440170131216,  7.37e-14 ],
            [ 1.49,  0.430082172265,  6.74e-14 ],
            [ 1.5,   0.420393163590,  6.25e-14 ],
            [ 1.51,  0.411080105357,  5.69e-14 ],
            [ 1.52,  0.402121742435,  5.37e-14 ],
            [ 1.53,  0.393498401168,  4.87e-14 ],
            [ 1.54,  0.385191844203,  4.64e-14 ],
            [ 1.55,  0.377185141069,  4.2e-14 ],
            [ 1.56,  0.369462552556,  3.89e-14 ],
            [ 1.57,  0.362009427195,  3.5e-14 ],
            [ 1.58,  0.354812108387,  3.36e-14 ],
            [ 1.59,  0.347857850924,  3.15e-14 ],
            [ 1.6,   0.341134745805,  2.9e-14 ],
            [ 1.61,  0.334631652405,  2.62e-14 ],
            [ 1.62,  0.328338137163,  2.48e-14 ],
            [ 1.63,  0.322244418070,  2.23e-14 ],
            [ 1.64,  0.316341314331,  2.05e-14 ],
            [ 1.65,  0.310620200635,  1.88e-14 ],
            [ 1.66,  0.305072965558,  1.8e-14 ],
            [ 1.67,  0.299691973657,  1.5e-14 ],
            [ 1.68,  0.294470030894,  2.32e-13 ],
            [ 1.69,  0.289400353031,  2.35e-13 ],
            [ 1.7,   0.284476536720,  2.14e-13 ],
            [ 1.71,  0.279692533017,  1.97e-13 ],
            [ 1.72,  0.275042623079,  1.8e-13 ],
            [ 1.73,  0.270521395847,  1.63e-13 ],
            [ 1.74,  0.266123727523,  1.48e-13 ],
            [ 1.75,  0.261844762667,  1.33e-13 ],
            [ 1.76,  0.257679896783,  1.2e-13 ],
            [ 1.77,  0.253624760244,  1.07e-13 ],
            [ 1.78,  0.249675203440,  9.34e-14 ],
            [ 1.79,  0.245827283048,  8.18e-14 ],
            [ 1.8,   0.242077249322,  7.02e-14 ],
            [ 1.81,  0.238421534307,  5.97e-14 ],
            [ 1.82,  0.234856740918,  4.96e-14 ],
            [ 1.83,  0.231379632794,  4.01e-14 ],
            [ 1.84,  0.227987124870,  2e-13 ],
            [ 1.85,  0.224676274605,  7.92e-14 ],
            [ 1.86,  0.221444273825,  4.7e-14 ],
            [ 1.87,  0.218288441110,  1.68e-13 ],
            [ 1.88,  0.215206214705,  1.69e-13 ],
            [ 1.89,  0.212195145893,  1.23e-13 ],
            [ 1.9,   0.209252892818,  1.26e-13 ],
            [ 1.91,  0.206377214698,  1.29e-13 ],
            [ 1.92,  0.203565966421,  1.31e-13 ],
            [ 1.93,  0.200817093476,  1.34e-13 ],
            [ 1.94,  0.198128627213,  1.36e-13 ],
            [ 1.95,  0.195498680395,  1.38e-13 ],
            [ 1.96,  0.192925443022,  1.41e-13 ],
            [ 1.97,  0.190407178413,  1.43e-13 ],
            [ 1.98,  0.187942219526,  1.45e-13 ],
            [ 1.99,  0.185528965498,  1.48e-13 ],
            [ 2,     0.183165877,     5.25e-10 ],
            [ 2.02,  0.178584349525,  1.54e-13 ],
            [ 2.04,  0.174186475715,  1.57e-13 ],
            [ 2.06,  0.169961927797,  1.61e-13 ],
            [ 2.08,  0.165901129231,  1.64e-13 ],
            [ 2.1,   0.161995188760,  1.67e-13 ],
            [ 2.12,  0.158235840193,  1.7e-13 ],
            [ 2.14,  0.154615388450,  1.73e-13 ],
            [ 2.16,  0.151126661115,  1.76e-13 ],
            [ 2.18,  0.147762964840,  1.78e-13 ],
            [ 2.2,   0.144518046064,  1.81e-13 ],
            [ 2.22,  0.141386055531,  1.84e-13 ],
            [ 2.24,  0.138361516203,  1.86e-13 ],
            [ 2.26,  0.135439294180,  1.89e-13 ],
            [ 2.28,  0.132614572315,  1.91e-13 ],
            [ 2.3,   0.129882826225,  1.93e-13 ],
            [ 2.32,  0.127239802452,  1.95e-13 ],
            [ 2.34,  0.124681498559,  1.96e-13 ],
            [ 2.36,  0.122204144951,  1.99e-13 ],
            [ 2.38,  0.119804188254,  2e-13 ],
            [ 2.4,   0.117478276102,  2.02e-13 ],
            [ 2.42,  0.115223243191,  2.04e-13 ],
            [ 2.44,  0.113036098474,  2.05e-13 ],
            [ 2.46,  0.110914013402,  2.07e-13 ],
            [ 2.48,  0.108854311094,  2.08e-13 ],
            [ 2.5,   0.106854456372,  2.09e-13 ],
            [ 2.52,  0.104912046561,  2.1e-13 ],
            [ 2.54,  0.103024803007,  2.11e-13 ],
            [ 2.56,  0.101190563227,  2.13e-13 ],
            [ 2.58,  0.099407273658,  2.14e-13 ],
            [ 2.6,   0.097672982930,  2.15e-13 ],
            [ 2.62,  0.095985835641,  2.16e-13 ],
            [ 2.64,  0.094344066576,  2.17e-13 ],
            [ 2.66,  0.092745995339,  2.18e-13 ],
            [ 2.68,  0.091190021363,  2.18e-13 ],
            [ 2.7,   0.089674619269,  2.19e-13 ],
            [ 2.72,  0.088198334542,  2.19e-13 ],
            [ 2.74,  0.086759779502,  2.2e-13 ],
            [ 2.76,  0.085357629548,  2.2e-13 ],
            [ 2.78,  0.083990619649,  2.2e-13 ],
            [ 2.8,   0.082657541067,  2.21e-13 ],
            [ 2.82,  0.081357238296,  2.21e-13 ],
            [ 2.84,  0.080088606194,  2.21e-13 ],
            [ 2.86,  0.078850587297,  2.21e-13 ],
            [ 2.88,  0.077642169310,  2.21e-13 ],
            [ 2.9,   0.076462382744,  2.21e-13 ],
            [ 2.92,  0.075310298707,  2.21e-13 ],
            [ 2.94,  0.074185026827,  2.21e-13 ],
            [ 2.96,  0.073085713298,  2.21e-13 ],
            [ 2.98,  0.072011539050,  2.2e-13 ],
            [ 3,     0.070961718021,  2.2e-13 ],
            [ 3.05,  0.068438831313,  2.19e-13 ],
            [ 3.1,   0.066052512606,  2.18e-13 ],
            [ 3.15,  0.063792791291,  2.17e-13 ],
            [ 3.2,   0.061650613654,  2.15e-13 ],
            [ 3.25,  0.059617741307,  2.14e-13 ],
            [ 3.3,   0.057686662751,  2.12e-13 ],
            [ 3.35,  0.055850516133,  2.1e-13 ],
            [ 3.4,   0.054103021589,  2.11e-13 ],
            [ 3.45,  0.052438421801,  2.09e-13 ],
            [ 3.5,   0.050851429648,  2.07e-13 ],
            [ 3.55,  0.049337181981,  2.04e-13 ],
            [ 3.6,   0.047891198693,  2.02e-13 ],
            [ 3.65,  0.046509346409,  1.99e-13 ],
            [ 3.7,   0.045187806193,  1.97e-13 ],
            [ 3.75,  0.043923044760,  1.94e-13 ],
            [ 3.8,   0.042711788774,  1.91e-13 ],
            [ 3.85,  0.041551001836,  1.89e-13 ],
            [ 3.9,   0.040437863853,  1.86e-13 ],
            [ 3.95,  0.039369752510,  1.83e-13 ],
            [ 4,     0.038344226580,  1.8e-13 ],
            [ 4.1,   0.036411982753,  1.75e-13 ],
            [ 4.2,   0.034624688139,  1.7e-13 ],
            [ 4.3,   0.032967971705,  1.64e-13 ],
            [ 4.4,   0.031429225568,  1.59e-13 ],
            [ 4.5,   0.029997348356,  1.54e-13 ],
            [ 4.6,   0.028662531591,  1.49e-13 ],
            [ 4.7,   0.027416080995,  1.44e-13 ],
            [ 4.8,   0.026250266248,  1.39e-13 ],
            [ 4.9,   0.025158194112,  1.34e-13 ],
            [ 5,     0.024133700811,  1.3e-13 ],
            [ 5.1,   0.023171260364,  1.25e-13 ],
            [ 5.2,   0.022265906215,  1.2e-13 ],
            [ 5.3,   0.021413163961,  1.15e-13 ],
            [ 5.4,   0.020608993431,  1.12e-13 ],
            [ 5.5,   0.019849738617,  1.08e-13 ],
            [ 5.6,   0.019132084278,  1.04e-13 ],
            [ 5.7,   0.018453018203,  1.01e-13 ],
            [ 5.8,   0.017809798293,  9.75e-14 ],
            [ 5.9,   0.017199923780,  9.42e-14 ],
            [ 6,     0.016621109981,  9.11e-14 ],
            [ 6.1,   0.016071266108,  8.81e-14 ],
            [ 6.2,   0.015548475706,  8.53e-14 ],
            [ 6.3,   0.015050979371,  8.26e-14 ],
            [ 6.4,   0.014577159453,  8e-14 ],
            [ 6.5,   0.014125526475,  7.74e-14 ],
            [ 6.6,   0.013694707054,  7.5e-14 ],
            [ 6.7,   0.013283433146,  7.27e-14 ],
            [ 6.8,   0.012890532434,  7.04e-14 ],
            [ 6.9,   0.012514919736,  6.82e-14 ],
            [ 7,     0.012155589298,  6.62e-14 ],
        ],
        [
            [ 1.001, 392.819010473,   1.29e-09 ],
            [ 1.002, 196.468900079,   6.09e-10 ],
            [ 1.003, 131.01848606816, 6.17e-12 ],
            [ 1.004, 98.29299800113,  1.58e-11 ],
            [ 1.005, 78.657481779281, 2.02e-12 ],
            [ 1.006, 65.5669526925,   1.72e-10 ],
            [ 1.007, 56.2164172855,   1.26e-10 ],
            [ 1.008, 49.20337882413,  1.57e-11 ],
            [ 1.009, 43.748672449156, 1.96e-12 ],
            [ 1.01,  39.384799239738, 4.54e-12 ],
            [ 1.02,  19.744472397085, 2.91e-13 ],
            [ 1.03,  13.194338488934, 3.45e-13 ],
            [ 1.04,  9.916908007789,  1.81e-13 ],
            [ 1.05,  7.948673975243,  7.82e-14 ],
            [ 1.06,  6.635127168142,  2.31e-13 ],
            [ 1.07,  5.695758234365,  2.26e-13 ],
            [ 1.08,  4.990308176019,  8.62e-14 ],
            [ 1.09,  4.440851807929,  7.37e-14 ],
            [ 1.1,   4.000631112457,  3.91e-14 ],
            [ 1.11,  3.639888559552,  5.55e-14 ],
            [ 1.12,  3.338783748016,  4.53e-13 ],
            [ 1.13,  3.083579273850,  3.62e-13 ],
            [ 1.14,  2.864461213671,  2.9e-13 ],
            [ 1.15,  2.674231404118,  2.37e-13 ],
            [ 1.16,  2.507490107540,  1.75e-13 ],
            [ 1.17,  2.360107141074,  1.49e-13 ],
            [ 1.18,  2.228869289627,  1.31e-13 ],
            [ 1.19,  2.111239056670,  1.06e-13 ],
            [ 1.2,   2.005185785122,  8.75e-14 ],
            [ 1.21,  1.909065025395,  7.73e-14 ],
            [ 1.22,  1.821530799595,  4.86e-14 ],
            [ 1.23,  1.741470750322,  5.4e-14 ],
            [ 1.24,  1.667957499666,  4.69e-14 ],
            [ 1.25,  1.600211679762,  4.37e-14 ],
            [ 1.26,  1.537573492782,  2.78e-14 ],
            [ 1.27,  1.479480589175,  4.62e-13 ],
            [ 1.28,  1.425450684766,  4.02e-13 ],
            [ 1.29,  1.375067772958,  3.55e-13 ],
            [ 1.3,   1.327971093308,  2.84e-13 ],
            [ 1.31,  1.283846234169,  2.5e-13 ],
            [ 1.32,  1.242417902641,  2.18e-13 ],
            [ 1.33,  1.203444008251,  1.83e-13 ],
            [ 1.34,  1.166710789955,  1.56e-13 ],
            [ 1.35,  1.132028777838,  1.33e-13 ],
            [ 1.36,  1.099229427283,  1.2e-13 ],
            [ 1.37,  1.068162298422,  1.01e-13 ],
            [ 1.38,  1.038692680454,  8.75e-14 ],
            [ 1.39,  1.010699581038,  7.02e-14 ],
            [ 1.4,   0.984074016880,  6e-14 ],
            [ 1.41,  0.958717554147,  4.8e-14 ],
            [ 1.42,  0.934541057066,  3.46e-14 ],
            [ 1.43,  0.911463610869,  4.53e-13 ],
            [ 1.44,  0.889411591342,  3.23e-13 ],
            [ 1.45,  0.868317858211,  2.02e-13 ],
            [ 1.46,  0.848121053520,  9.38e-14 ],
            [ 1.47,  0.828764989399,  1.35e-14 ],
            [ 1.48,  0.810198112172,  1.09e-13 ],
            [ 1.49,  0.792373031939,  2.06e-13 ],
            [ 1.5,   0.775246108457,  2.97e-13 ],
            [ 1.51,  0.758777085611,  3.89e-13 ],
            [ 1.52,  0.742928767940,  5.28e-14 ],
            [ 1.53,  0.727666733674,  6.03e-14 ],
            [ 1.54,  0.712959079551,  6.23e-14 ],
            [ 1.55,  0.698776193389,  6.72e-14 ],
            [ 1.56,  0.685090550924,  7.22e-14 ],
            [ 1.57,  0.671876533976,  8.13e-14 ],
            [ 1.58,  0.659110267333,  8.64e-14 ],
            [ 1.59,  0.646769472174,  9.13e-14 ],
            [ 1.6,   0.634833334077,  1.04e-13 ],
            [ 1.61,  0.623282383960,  1.12e-13 ],
            [ 1.62,  0.612098390491,  1.21e-13 ],
            [ 1.63,  0.601264262697,  1.29e-13 ],
            [ 1.64,  0.590763961657,  1.39e-13 ],
            [ 1.65,  0.580582420305,  1.5e-13 ],
            [ 1.66,  0.570705470495,  1.61e-13 ],
            [ 1.67,  0.561119776548,  1.72e-13 ],
            [ 1.68,  0.551812774642,  1.83e-13 ],
            [ 1.69,  0.542772617435,  1.95e-13 ],
            [ 1.7,   0.533988123411,  2.07e-13 ],
            [ 1.71,  0.525448730481,  2.18e-13 ],
            [ 1.72,  0.517144453420,  2.31e-13 ],
            [ 1.73,  0.509065844787,  2.4e-13 ],
            [ 1.74,  0.501203958992,  2.51e-13 ],
            [ 1.75,  0.493550319212,  2.62e-13 ],
            [ 1.76,  0.486096886909,  2.73e-13 ],
            [ 1.77,  0.478836033699,  2.8e-13 ],
            [ 1.78,  0.471760515376,  2.89e-13 ],
            [ 1.79,  0.464863447888,  2.97e-13 ],
            [ 1.8,   0.458138285105,  3.04e-13 ],
            [ 1.81,  0.451578798220,  3.09e-13 ],
            [ 1.82,  0.445179056642,  3.12e-13 ],
            [ 1.83,  0.438933410267,  3.15e-13 ],
            [ 1.84,  0.432836472994,  3.17e-13 ],
            [ 1.85,  0.426883107403,  3.14e-13 ],
            [ 1.86,  0.421068410492,  3.13e-13 ],
            [ 1.87,  0.415387700384,  3.08e-13 ],
            [ 1.88,  0.409836503937,  3.01e-13 ],
            [ 1.89,  0.404410545177,  2.91e-13 ],
            [ 1.9,   0.399105734502,  2.83e-13 ],
            [ 1.91,  0.393918158586,  2.69e-13 ],
            [ 1.92,  0.388844070933,  2.53e-13 ],
            [ 1.93,  0.383879883040,  2.34e-13 ],
            [ 1.94,  0.379022156118,  2.13e-13 ],
            [ 1.95,  0.374267593323,  1.92e-13 ],
            [ 1.96,  0.369613032479,  1.63e-13 ],
            [ 1.97,  0.365055439238,  1.33e-13 ],
            [ 1.98,  0.360591900655,  1e-13 ],
            [ 1.99,  0.356219619154,  6.52e-14 ],
            [ 2,     0.3519359079,    2.73e-10 ],
            [ 2.02,  0.343623954944,  2.51e-13 ],
            [ 2.04,  0.335636540064,  1.57e-13 ],
            [ 2.06,  0.327955600766,  2.68e-13 ],
            [ 2.08,  0.320564387483,  3.91e-13 ],
            [ 2.1,   0.313447345146,  7.22e-14 ],
            [ 2.12,  0.306590008240,  9.2e-14 ],
            [ 2.14,  0.299978906779,  1.15e-13 ],
            [ 2.16,  0.293601481877,  1.39e-13 ],
            [ 2.18,  0.287446009817,  1.67e-13 ],
            [ 2.2,   0.281501533602,  1.96e-13 ],
            [ 2.22,  0.275757801162,  2.26e-13 ],
            [ 2.24,  0.270205209459,  2.57e-13 ],
            [ 2.26,  0.264834753847,  2.91e-13 ],
            [ 2.28,  0.259637982120,  3.28e-13 ],
            [ 2.3,   0.254606952734,  3.66e-13 ],
            [ 2.32,  0.249734196788,  4.03e-13 ],
            [ 2.34,  0.245012683350,  4.33e-13 ],
            [ 2.36,  0.240435787814,  4.73e-13 ],
            [ 2.38,  0.235997262953,  7.72e-14 ],
            [ 2.4,   0.231691212435,  8.43e-14 ],
            [ 2.42,  0.227512066530,  9.21e-14 ],
            [ 2.44,  0.223454559822,  1.01e-13 ],
            [ 2.46,  0.219513710723,  1.08e-13 ],
            [ 2.48,  0.215684802623,  1.16e-13 ],
            [ 2.5,   0.211963366526,  1.25e-13 ],
            [ 2.52,  0.208345165038,  1.33e-13 ],
            [ 2.54,  0.204826177581,  1.41e-13 ],
            [ 2.56,  0.201402586732,  1.51e-13 ],
            [ 2.58,  0.198070765578,  1.58e-13 ],
            [ 2.6,   0.194827266011,  1.7e-13 ],
            [ 2.62,  0.191668807872,  1.79e-13 ],
            [ 2.64,  0.188592268882,  1.88e-13 ],
            [ 2.66,  0.185594675285,  1.98e-13 ],
            [ 2.68,  0.182673193151,  2.06e-13 ],
            [ 2.7,   0.179825120287,  2.15e-13 ],
            [ 2.72,  0.177047878698,  2.24e-13 ],
            [ 2.74,  0.174339007563,  2.33e-13 ],
            [ 2.76,  0.171696156685,  2.42e-13 ],
            [ 2.78,  0.169117080367,  2.5e-13 ],
            [ 2.8,   0.166599631703,  2.59e-13 ],
            [ 2.82,  0.164141757230,  2.68e-13 ],
            [ 2.84,  0.161741491924,  2.77e-13 ],
            [ 2.86,  0.159396954521,  2.86e-13 ],
            [ 2.88,  0.157106343123,  2.95e-13 ],
            [ 2.9,   0.154867931084,  3.02e-13 ],
            [ 2.92,  0.152680063147,  3.1e-13 ],
            [ 2.94,  0.150541151815,  3.18e-13 ],
            [ 2.96,  0.148449673943,  3.25e-13 ],
            [ 2.98,  0.146404167534,  3.33e-13 ],
            [ 3,     0.144403228720,  3.41e-13 ],
            [ 3.05,  0.139587143750,  3.58e-13 ],
            [ 3.1,   0.135021638057,  3.77e-13 ],
            [ 3.15,  0.130688852079,  3.93e-13 ],
            [ 3.2,   0.126572545356,  4.08e-13 ],
            [ 3.25,  0.122657918644,  4.22e-13 ],
            [ 3.3,   0.118931458916,  4.34e-13 ],
            [ 3.35,  0.115380803894,  4.46e-13 ],
            [ 3.4,   0.111994623297,  4.56e-13 ],
            [ 3.45,  0.108762514453,  4.65e-13 ],
            [ 3.5,   0.105674910278,  4.73e-13 ],
            [ 3.55,  0.102722997960,  4.81e-13 ],
            [ 3.6,   0.099898646915,  4.87e-13 ],
            [ 3.65,  0.097194344810,  4.92e-13 ],
            [ 3.7,   0.094603140617,  4.96e-13 ],
            [ 3.75,  0.092118593816,  4.99e-13 ],
            [ 3.8,   0.089734728990,  9.81e-14 ],
            [ 3.85,  0.087445995150,  9.86e-14 ],
            [ 3.9,   0.085247229231,  9.93e-14 ],
            [ 3.95,  0.083133623274,  9.98e-14 ],
            [ 4,     0.081100694851,  1e-13 ],
            [ 4.1,   0.077260411069,  1e-13 ],
            [ 4.2,   0.073696077196,  4.96e-13 ],
            [ 4.3,   0.070381136724,  4.9e-13 ],
            [ 4.4,   0.067292224992,  4.81e-13 ],
            [ 4.5,   0.064408711106,  4.72e-13 ],
            [ 4.6,   0.061712315941,  4.61e-13 ],
            [ 4.7,   0.059186791928,  4.5e-13 ],
            [ 4.8,   0.056817653328,  4.38e-13 ],
            [ 4.9,   0.054591947974,  4.26e-13 ],
            [ 5,     0.052498063280,  4.13e-13 ],
            [ 5.1,   0.050525560675,  4e-13 ],
            [ 5.2,   0.048665033758,  3.87e-13 ],
            [ 5.3,   0.046907986311,  3.74e-13 ],
            [ 5.4,   0.045246727032,  3.62e-13 ],
            [ 5.5,   0.043674278378,  3.49e-13 ],
            [ 5.6,   0.042184297387,  3.37e-13 ],
            [ 5.7,   0.040771006677,  3.25e-13 ],
            [ 5.8,   0.039429134158,  3.13e-13 ],
            [ 5.9,   0.038153860192,  3.01e-13 ],
            [ 6,     0.036940771166,  2.9e-13 ],
            [ 6.1,   0.035785818592,  2.79e-13 ],
            [ 6.2,   0.034685282992,  2.68e-13 ],
            [ 6.3,   0.033635741919,  2.58e-13 ],
            [ 6.4,   0.032634041599,  2.48e-13 ],
            [ 6.5,   0.031677271701,  2.39e-13 ],
            [ 6.6,   0.030762742870,  2.29e-13 ],
            [ 6.7,   0.029887966658,  2.2e-13 ],
            [ 6.8,   0.029050637575,  2.12e-13 ],
            [ 6.9,   0.028248617003,  2.04e-13 ],
            [ 7,     0.027479918747,  1.96e-13 ],
        ],
        [
            [ 1.001,        335.205632767,   1.11e-09 ],
            [ 1.002,        167.65361519779, 2.84e-11 ],
            [ 1.003,        111.8026713564,  2.85e-10 ],
            [ 1.004,        83.8769971378,   2.34e-10 ],
            [ 1.005,        67.121431713354, 3.3e-12 ],
            [ 1.006,        55.950921469257, 1.85e-12 ],
            [ 1.007,        47.9718719944,   1.23e-10 ],
            [ 1.008,        41.9874860790,   7.55e-11 ],
            [ 1.009,        37.33287638082,  1.9e-11 ],
            [ 1.01,         33.60911049159,  5.83e-12 ],
            [ 1.02,         16.85006450652,  6.52e-12 ],
            [ 1.03,         11.26127133433,  6.68e-12 ],
            [ 1.04,         8.465143317159,  2.31e-14 ],
            [ 1.05,         6.786157584719,  4.03e-13 ],
            [ 1.06,         5.665802412362,  2.09e-13 ],
            [ 1.07,         4.864712387894,  1.55e-13 ],
            [ 1.08,         4.263202181931,  9.24e-14 ],
            [ 1.09,         3.794777787671,  6.17e-14 ],
            [ 1.1,          3.419541003053,  2.04e-14 ],
            [ 1.11,         3.112100547746,  4.68e-13 ],
            [ 1.12,         2.855527612354,  3.6e-13 ],
            [ 1.13,         2.638101146388,  2.74e-13 ],
            [ 1.14,         2.451448016322,  2.04e-13 ],
            [ 1.15,         2.289427094928,  1.68e-13 ],
            [ 1.16,         2.147431812448,  1.29e-13 ],
            [ 1.17,         2.021938862183,  1.04e-13 ],
            [ 1.18,         1.910207334131,  9.48e-14 ],
            [ 1.19,         1.810072856103,  7.02e-14 ],
            [ 1.2,          1.719803489954,  5.95e-14 ],
            [ 1.21,         1.637996798096,  4.84e-14 ],
            [ 1.22,         1.563504980851,  4.4e-14 ],
            [ 1.23,         1.495379541498,  4.04e-14 ],
            [ 1.24,         1.432829783574,  4.83e-13 ],
            [ 1.25,         1.375191267517,  4.12e-13 ],
            [ 1.26,         1.321901545403,  3.49e-13 ],
            [ 1.27,         1.272481286935,  3.04e-13 ],
            [ 1.28,         1.226519448971,  2.33e-13 ],
            [ 1.29,         1.183661512623,  2e-13 ],
            [ 1.3,          1.143600072220,  1.63e-13 ],
            [ 1.31,         1.106067245131,  1.37e-13 ],
            [ 1.32,         1.070828504180,  1.13e-13 ],
            [ 1.33,         1.037677630924,  9.55e-14 ],
            [ 1.34,         1.006432559081,  7.88e-14 ],
            [ 1.35,         0.976931930102,  5.98e-14 ],
            [ 1.36,         0.949032222441,  4.72e-14 ],
            [ 1.37,         0.922605346025,  3.22e-14 ],
            [ 1.38,         0.897536616237,  3.64e-13 ],
            [ 1.39,         0.873723039325,  2.06e-13 ],
            [ 1.4,          0.851071854758,  5.84e-14 ],
            [ 1.41,         0.829499290670,  8.03e-14 ],
            [ 1.42,         0.808929496893,  2.12e-13 ],
            [ 1.43,         0.789293626694,  3.44e-13 ],
            [ 1.44,         0.770529043555,  4.72e-13 ],
            [ 1.45,         0.752578633564,  6.49e-14 ],
            [ 1.46,         0.735390207363,  7.22e-14 ],
            [ 1.47,         0.718915978304,  7.87e-14 ],
            [ 1.48,         0.703112105733,  9.04e-14 ],
            [ 1.49,         0.687938294082,  1.03e-13 ],
            [ 1.5,          0.673357439976,  1.13e-13 ],
            [ 1.51,         0.659335320773,  1.28e-13 ],
            [ 1.52,         0.645840318948,  1.45e-13 ],
            [ 1.53,         0.632843177620,  1.62e-13 ],
            [ 1.54,         0.620316783157,  1.81e-13 ],
            [ 1.55,         0.608235971443,  2.04e-13 ],
            [ 1.56,         0.596577354843,  2.25e-13 ],
            [ 1.57,         0.585319167327,  2.46e-13 ],
            [ 1.58,         0.574441125560,  2.69e-13 ],
            [ 1.59,         0.563924304084,  2.92e-13 ],
            [ 1.6,          0.553751022931,  3.15e-13 ],
            [ 1.61,         0.543904746248,  3.35e-13 ],
            [ 1.62,         0.534369990710,  3.54e-13 ],
            [ 1.63,         0.525132242604,  3.71e-13 ],
            [ 1.64,         0.516177882670,  3.85e-13 ],
            [ 1.65,         0.507494117842,  3.94e-13 ],
            [ 1.66,         0.499068919169,  4e-13 ],
            [ 1.67,         0.490890965272,  3.99e-13 ],
            [ 1.68,         0.482949590768,  3.9e-13 ],
            [ 1.69,         0.475234739152,  3.73e-13 ],
            [ 1.7,          0.467736919700,  3.46e-13 ],
            [ 1.71,         0.460447168002,  3.08e-13 ],
            [ 1.72,         0.453357009750,  2.6e-13 ],
            [ 1.73,         0.446458427507,  2e-13 ],
            [ 1.74,         0.439743830136,  1.24e-13 ],
            [ 1.75,         0.433206024673,  3.5e-14 ],
            [ 1.76,         0.426838190401,  2.7e-13 ],
            [ 1.77,         0.420633854935,  1.93e-13 ],
            [ 1.78,         0.414586872133,  3.33e-13 ],
            [ 1.79,         0.408691401676,  4.91e-13 ],
            [ 1.8,          0.402941890163,  9.18e-14 ],
            [ 1.81,         0.397333053610,  1.2e-13 ],
            [ 1.82,         0.391859861202,  1.49e-13 ],
            [ 1.83,         0.386517520230,  1.85e-13 ],
            [ 1.84,         0.381301462082,  2.23e-13 ],
            [ 1.85,         0.376207329224,  2.65e-13 ],
            [ 1.86,         0.371230963076,  3.12e-13 ],
            [ 1.87,         0.366368392725,  3.62e-13 ],
            [ 1.88,         0.361615824394,  4.18e-13 ],
            [ 1.89,         0.356969631619,  4.74e-13 ],
            [ 1.9,          0.352426346075,  7.77e-14 ],
            [ 1.91,         0.347982649003,  9.07e-14 ],
            [ 1.92,         0.343635363189,  1.01e-13 ],
            [ 1.93,         0.339381445457,  1.14e-13 ],
            [ 1.94,         0.335217979634,  1.27e-13 ],
            [ 1.95,         0.331142169963,  1.42e-13 ],
            [ 1.96,         0.327151334917,  1.56e-13 ],
            [ 1.97,         0.323242901393,  1.72e-13 ],
            [ 1.98,         0.319414399259,  1.89e-13 ],
            [ 1.99,         0.315663456230,  2.06e-13 ],
            [ 2,            0.311987793,     8.38e-10 ],
            [ 2.02,         0.304853627340,  2.67e-13 ],
            [ 2.04,         0.297995362599,  3.13e-13 ],
            [ 2.06,         0.291397683242,  3.61e-13 ],
            [ 2.08,         0.285046386008,  4.1e-13 ],
            [ 2.1,          0.278928280364,  4.67e-13 ],
            [ 2.12,         0.273031099468,  8.85e-14 ],
            [ 2.14,         0.267343420407,  9.88e-14 ],
            [ 2.16,         0.261854592587,  1.12e-13 ],
            [ 2.18,         0.256554673325,  1.23e-13 ],
            [ 2.2,          0.251434369806,  1.4e-13 ],
            [ 2.22,         0.246484986681,  1.48e-13 ],
            [ 2.24,         0.241698378674,  1.65e-13 ],
            [ 2.26,         0.237066907648,  1.78e-13 ],
            [ 2.28,         0.232583403643,  1.95e-13 ],
            [ 2.3,          0.228241129467,  2.09e-13 ],
            [ 2.32,         0.224033748464,  2.25e-13 ],
            [ 2.34,         0.219955295129,  2.4e-13 ],
            [ 2.36,         0.216000148283,  2.56e-13 ],
            [ 2.38,         0.212163006546,  2.75e-13 ],
            [ 2.4,          0.208438865890,  2.92e-13 ],
            [ 2.42,         0.204822999056,  3.07e-13 ],
            [ 2.44,         0.201310936666,  3.24e-13 ],
            [ 2.46,         0.197898449863,  3.4e-13 ],
            [ 2.48,         0.194581534345,  3.53e-13 ],
            [ 2.5,          0.191356395648,  3.67e-13 ],
            [ 2.52,         0.188219435582,  3.83e-13 ],
            [ 2.54,         0.185167239709,  3.96e-13 ],
            [ 2.56,         0.182196565760,  4.09e-13 ],
            [ 2.58,         0.179304332933,  4.21e-13 ],
            [ 2.6,          0.176487611972,  4.32e-13 ],
            [ 2.62,         0.173743615970,  4.44e-13 ],
            [ 2.64,         0.171069691844,  4.54e-13 ],
            [ 2.66,         0.168463312405,  4.63e-13 ],
            [ 2.68,         0.165922068992,  4.74e-13 ],
            [ 2.7,          0.163443664623,  4.82e-13 ],
            [ 2.72,         0.161025907604,  4.89e-13 ],
            [ 2.74,         0.158666705583,  4.97e-13 ],
            [ 2.76,         0.156364059999,  1.06e-13 ],
            [ 2.78,         0.154116060902,  1.07e-13 ],
            [ 2.8,          0.151920882106,  1.1e-13 ],
            [ 2.82,         0.149776776666,  1.12e-13 ],
            [ 2.84,         0.147682072639,  1.13e-13 ],
            [ 2.86,         0.145635169120,  1.13e-13 ],
            [ 2.88,         0.143634532518,  1.13e-13 ],
            [ 2.9,          0.141678693073,  1.15e-13 ],
            [ 2.92,         0.139766241583,  1.15e-13 ],
            [ 2.94,         0.137895826331,  1.16e-13 ],
            [ 2.96,         0.136066150195,  1.15e-13 ],
            [ 2.98,         0.134275967937,  1.15e-13 ],
            [ 3,            0.132524083644,  1.14e-13 ],
            [ 3.05,         0.128304495613,  1.13e-13 ],
            [ 3.1,          0.124300435835,  4.87e-13 ],
            [ 3.15,         0.120496677615,  4.69e-13 ],
            [ 3.2,          0.116879368963,  4.46e-13 ],
            [ 3.25,         0.113435881837,  4.22e-13 ],
            [ 3.3,          0.110154680785,  3.96e-13 ],
            [ 3.35,         0.107025208115,  3.68e-13 ],
            [ 3.4,          0.104037783228,  3.38e-13 ],
            [ 3.45,         0.101183514108,  3.09e-13 ],
            [ 3.5,          0.098454219296,  2.78e-13 ],
            [ 3.55,         0.095842358920,  2.47e-13 ],
            [ 3.6,          0.093340973588,  2.16e-13 ],
            [ 3.65,         0.090943630108,  1.86e-13 ],
            [ 3.7,          0.088644373166,  1.56e-13 ],
            [ 3.75,         0.086437682222,  1.27e-13 ],
            [ 3.8,          0.084318432956,  4.02e-13 ],
            [ 3.85,         0.082281862744,  2.91e-13 ],
            [ 3.9,          0.080323539655,  1.88e-13 ],
            [ 3.95,         0.078439334573,  3.64e-13 ],
            [ 4,            0.076625396079,  1.09e-13 ],
            [ 4.1,          0.073194167803,  1.6e-13 ],
            [ 4.2,          0.070003788337,  2.94e-13 ],
            [ 4.3,          0.067031389568,  4.01e-13 ],
            [ 4.4,          0.064256831937,  4.82e-13 ],
            [ 4.5,          0.061662314608,  1.4e-13 ],
            [ 4.6,          0.059232050213,  1.51e-13 ],
            [ 4.7,          0.056951992073,  1.56e-13 ],
            [ 4.8,          0.054809604304,  1.58e-13 ],
            [ 4.9,          0.052793667174,  1.56e-13 ],
            [ 5,            0.050894111586,  1.52e-13 ],
            [ 5.1,          0.049101877754,  1.44e-13 ],
            [ 5.2,          0.047408794059,  1.36e-13 ],
            [ 5.3,          0.045807472827,  4.66e-13 ],
            [ 5.4,          0.044291220355,  4.23e-13 ],
            [ 5.5,          0.042853958967,  3.77e-13 ],
            [ 5.6,          0.041490159308,  3.31e-13 ],
            [ 5.7,          0.040194781339,  2.87e-13 ],
            [ 5.8,          0.038963222795,  2.43e-13 ],
            [ 5.9,          0.037791274043,  2.03e-13 ],
            [ 6,            0.036675078477,  1.65e-13 ],
            [ 6.1,          0.035611097715,  4.74e-13 ],
            [ 6.2,          0.034596080994,  3.63e-13 ],
            [ 6.3,          0.033627038280,  2.67e-13 ],
            [ 6.4,          0.032701216718,  1.87e-13 ],
            [ 6.5,          0.031816080191,  2.74e-13 ],
            [ 6.6,          0.030969291939,  2.41e-13 ],
            [ 6.7,          0.030158700568,  1.85e-13 ],
            [ 6.8,          0.029382330740,  4.03e-14 ],
            [ 6.9,          0.028638382976,  1.19e-13 ],
            [ 6.9999999999, 0.027925268033,  4.13e-16 ],
        ],
    ];

}

sub alpha_interpolate {
    my ( $sym, $gamma ) = @_;

    # Given: a 1d symmetry (0, 1, or 2) and an ideal gas gamma
    # return: parameter alpha for the similarity solution
    # returns undef if out of bounds of table
    # (currently gamma<1.1 || $gamma>7 )

    # alpha is obtained by interpolating a table of pre-computed values.
    # The table is spaced closely enough that cubic interpolation of the
    # interpolated values gives comparable accuracy to the tabulated values
    # (error below about 1.e-7 over most of the range).

    return if ( $sym != 0 && $sym != 1 && $sym != 2 );

    my $rtab = $ralpha_table->[$sym];
    my $ntab = @{$rtab};
    my ( $jl, $ju );
    my $icol = 0;

    # A small tolerance to avoid interpolations
    my $eps = 1.e-6;

    ( $jl, $ju ) = locate_2d( $gamma, $icol, $rtab, $jl, $ju );
    my ( $gamma_min, $alpha_min ) = @{ $rtab->[0] };
    my ( $gamma_max, $alpha_max ) = @{ $rtab->[1] };
    if ( $jl < 0 ) {
        return if ( $gamma + $eps < $gamma_min );
        return $alpha_min;
    }
    if ( $ju >= $ntab ) {
        return if ( $gamma - $eps > $gamma_max );
        return $alpha_max;
    }

    # Define N consecutive lagrange interpolation points;
    # Results of alpha_missing_point_test.t:
    # 4 interpolation points give max alpha error of 7.e-7
    # 6 interpolation points give max alpha error of 2.e-7
    my $NLAG = 6; #4;
    my $rj_interp = set_interpolation_points( $jl, $ntab, $NLAG );

    my ( $rx, $ry );

    # alpha varies approximately as 1/{ (gamma-1)*sqrt(gamma+1) },
    # so we can improve accuracy by interpolating the function
    # alpha*(gamma-1)*sqrt(gamma+1)
    foreach my $jj ( @{$rj_interp} ) {
        my ( $xx, $yy ) = @{ $rtab->[$jj] };
        push @{$rx}, $xx;
        push @{$ry}, $yy * ( $xx - 1 ) * sqrt( $xx + 1 );
    }

    my $ff = polint( $gamma, $rx, $ry );
    my $alpha = $ff / ( ( $gamma - 1 ) * sqrt( $gamma + 1 ) );

    return ($alpha);
}
1;
