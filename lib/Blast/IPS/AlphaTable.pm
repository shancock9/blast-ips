package Blast::IPS::AlphaTable;

# MIT License
# Copyright (c) 2018 Steven Hancock
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.

# This module provides a routine 'alpha_interpolate' which returns an accurate
# value of the similarity parameter alpha for the three symmetries and
# gamma between 1.1 and 7.

use strict;
use warnings;
use 5.006;

our @EXPORT_OK = qw(
  alpha_interpolate
);

use Exporter;
our @ISA = qw(Exporter);

use Carp;
our $ralpha_table;

use Blast::IPS::MathUtils qw(
  polint
  set_interpolation_points
  locate_2d
);

##################################################################
# ALPHA TABLE
##################################################################
BEGIN {

    # This table of values was created by integrating the Von Neumann
    # analytical solution using the script 'alpha_integrate.pl'. The values
    # are in good agreement with values produced by other software and
    # with the values extracted from the finite difference solutions.

    # The table format is:
    # $ralpha_table->[$symmetry]= [gamma, alpha, err];

    # where:
    #   symmetry = 0,1,2 for plane, cylindrical, spherical
    #   err = the estimated error in the value of alpha

    $ralpha_table = [
        [
            [ 1.01, 22.28576216753, 2.21e-11 ],
            [ 1.02, 11.17025752376, 1.93e-11 ],
            [ 1.03, 7.46239706034,  7.17e-12 ],
            [ 1.04, 5.60660785759,  3.06e-12 ],
            [ 1.05, 4.49176310829,  2.64e-11 ],
            [ 1.06, 3.74747821530,  1.46e-11 ],
            [ 1.07, 3.21501009188,  8.66e-12 ],
            [ 1.08, 2.81498188241,  5.45e-12 ],
            [ 1.09, 2.50329112437,  3.74e-12 ],
            [ 1.1,  2.25347295355,  4.05e-11 ],
            [ 1.11, 2.04868333302,  2.92e-11 ],
            [ 1.12, 1.87769063156,  2.34e-11 ],
            [ 1.13, 1.73271721422,  1.79e-11 ],
            [ 1.14, 1.60820604276,  1.56e-11 ],
            [ 1.15, 1.50008061748,  1.45e-11 ],
            [ 1.16, 1.40528242597,  1.14e-11 ],
            [ 1.17, 1.32147163302,  1.11e-11 ],
            [ 1.18, 1.24682753055,  8.99e-12 ],
            [ 1.19, 1.17991199497,  7.35e-12 ],
            [ 1.2,  1.11957390047,  6.07e-12 ],
            [ 1.21, 1.06488083697,  5.05e-12 ],
            [ 1.22, 1.01506944555,  4.25e-12 ],
            [ 1.23, 0.96950870577,  3.6e-12 ],
            [ 1.24, 0.89629582892,  3.78e-11 ],
            [ 1.25, 0.88911816980,  4.2e-11 ],
            [ 1.26, 0.85347143540,  3.63e-11 ],
            [ 1.27, 0.82041284472,  3.15e-11 ],
            [ 1.28, 0.78966844020,  2.75e-11 ],
            [ 1.29, 0.76100184674,  2.41e-11 ],
            [ 1.3,  0.73420802257,  2.13e-11 ],
            [ 1.31, 0.70910821842,  1.88e-11 ],
            [ 1.32, 0.68554588071,  1.67e-11 ],
            [ 1.33, 0.66338329874,  1.49e-11 ],
            [ 1.34, 0.64249884271,  1.34e-11 ],
            [ 1.35, 0.62278467452,  1.2e-11 ],
            [ 1.36, 0.60414483946,  1.08e-11 ],
            [ 1.37, 0.58649366677,  9.76e-12 ],
            [ 1.38, 0.56975442234,  8.84e-12 ],
            [ 1.39, 0.55385816812,  8.03e-12 ],
            [ 1.4,  0.53874279237,  7.31e-12 ],
            [ 1.41, 0.52435218135,  6.68e-12 ],
            [ 1.42, 0.51063550912,  6.11e-12 ],
            [ 1.43, 0.49754662616,  5.6e-12 ],
            [ 1.44, 0.48504353103,  5.14e-12 ],
            [ 1.45, 0.47308791237,  4.73e-12 ],
            [ 1.46, 0.46164475036,  4.37e-12 ],
            [ 1.47, 0.43586942670,  3.56e-12 ],
            [ 1.48, 0.44017013122,  3.73e-12 ],
            [ 1.49, 0.43008217227,  3.46e-12 ],
            [ 1.5,  0.42039316359,  3.21e-12 ],
            [ 1.51, 0.41108010536,  4.76e-11 ],
            [ 1.52, 0.40212174244,  4.43e-11 ],
            [ 1.53, 0.39349840117,  4.13e-11 ],
            [ 1.54, 0.38519184421,  3.86e-11 ],
            [ 1.55, 0.37718514107,  3.61e-11 ],
            [ 1.56, 0.36946255256,  3.38e-11 ],
            [ 1.57, 0.36200942720,  3.17e-11 ],
            [ 1.58, 0.35481210839,  2.97e-11 ],
            [ 1.59, 0.34785785093,  2.79e-11 ],
            [ 1.6,  0.34113474581,  2.63e-11 ],
            [ 1.61, 0.33463165241,  2.47e-11 ],
            [ 1.62, 0.32833813716,  2.33e-11 ],
            [ 1.63, 0.32224441807,  2.2e-11 ],
            [ 1.64, 0.31634131433,  2.08e-11 ],
            [ 1.65, 0.31062020064,  1.96e-11 ],
            [ 1.66, 0.30507296556,  1.86e-11 ],
            [ 1.67, 0.29969197366,  1.76e-11 ],
            [ 1.68, 0.29447003090,  1.67e-11 ],
            [ 1.69, 0.28940035303,  1.58e-11 ],
            [ 1.7,  0.28447653672,  1.5e-11 ],
            [ 1.71, 0.27969253302,  1.42e-11 ],
            [ 1.72, 0.27504262308,  1.35e-11 ],
            [ 1.73, 0.26182950178,  1.2e-11 ],
            [ 1.74, 0.26612372752,  1.23e-11 ],
            [ 1.75, 0.26184476267,  1.17e-11 ],
            [ 1.76, 0.25767989678,  1.11e-11 ],
            [ 1.77, 0.25362476024,  1.06e-11 ],
            [ 1.78, 0.24967520344,  1.01e-11 ],
            [ 1.79, 0.24582728305,  9.68e-12 ],
            [ 1.8,  0.24207724932,  9.24e-12 ],
            [ 1.81, 0.23842153431,  8.84e-12 ],
            [ 1.82, 0.23485674092,  8.45e-12 ],
            [ 1.83, 0.23137963279,  8.09e-12 ],
            [ 1.84, 0.22798712487,  7.75e-12 ],
            [ 1.85, 0.22467627461,  7.42e-12 ],
            [ 1.86, 0.22144427383,  7.11e-12 ],
            [ 1.87, 0.21828844111,  6.82e-12 ],
            [ 1.88, 0.21520621471,  6.54e-12 ],
            [ 1.89, 0.21219514589,  6.28e-12 ],
            [ 1.9,  0.20925289282,  6.03e-12 ],
            [ 1.91, 0.20637721470,  5.79e-12 ],
            [ 1.92, 0.20356596642,  5.57e-12 ],
            [ 1.93, 0.20081709348,  5.35e-12 ],
            [ 1.94, 0.19812862721,  5.15e-12 ],
            [ 1.95, 0.19549868040,  4.95e-12 ],
            [ 1.96, 0.19292544302,  4.77e-12 ],
            [ 1.97, 0.19040717841,  4.59e-12 ],
            [ 1.98, 0.18794221953,  4.42e-12 ],
            [ 1.99, 0.18552896550,  4.26e-12 ],
            [ 2,    0.18316545,     1.71e-07 ],
            [ 2.02, 0.17858434953,  3.82e-12 ],
            [ 2.04, 0.17418647571,  3.55e-12 ],
            [ 2.06, 0.16996192780,  3.31e-12 ],
            [ 2.08, 0.16590112923,  4.91e-11 ],
            [ 2.1,  0.16199518876,  4.58e-11 ],
            [ 2.12, 0.15823584020,  4.29e-11 ],
            [ 2.14, 0.15461538845,  4.01e-11 ],
            [ 2.16, 0.15112666112,  3.76e-11 ],
            [ 2.18, 0.14776296484,  3.52e-11 ],
            [ 2.2,  0.14451804607,  3.3e-11 ],
            [ 2.22, 0.14138605553,  3.1e-11 ],
            [ 2.24, 0.13836151620,  2.91e-11 ],
            [ 2.26, 0.13543929418,  2.73e-11 ],
            [ 2.28, 0.13261457232,  2.57e-11 ],
            [ 2.3,  0.12582131335,  2.33e-11 ],
            [ 2.32, 0.12723980245,  2.28e-11 ],
            [ 2.34, 0.12468149856,  2.14e-11 ],
            [ 2.36, 0.12220414495,  2.02e-11 ],
            [ 2.38, 0.11980418826,  1.9e-11 ],
            [ 2.4,  0.11747827610,  1.79e-11 ],
            [ 2.42, 0.11522324319,  1.69e-11 ],
            [ 2.44, 0.11303609848,  1.59e-11 ],
            [ 2.46, 0.11091401340,  1.5e-11 ],
            [ 2.48, 0.10885431110,  1.42e-11 ],
            [ 2.5,  0.10685445637,  1.34e-11 ],
            [ 2.52, 0.10491204656,  1.26e-11 ],
            [ 2.54, 0.10302480301,  1.19e-11 ],
            [ 2.56, 0.10119056323,  1.12e-11 ],
            [ 2.58, 0.09940727366,  1.06e-11 ],
            [ 2.6,  0.09464371557,  9.68e-12 ],
            [ 2.62, 0.09598583564,  9.4e-12 ],
            [ 2.64, 0.09434406658,  8.86e-12 ],
            [ 2.66, 0.09274599534,  8.35e-12 ],
            [ 2.68, 0.09119002136,  7.87e-12 ],
            [ 2.7,  0.08967461927,  7.42e-12 ],
            [ 2.72, 0.08819833454,  6.98e-12 ],
            [ 2.74, 0.08675977950,  6.57e-12 ],
            [ 2.76, 0.08535762955,  6.18e-12 ],
            [ 2.78, 0.08399061965,  5.81e-12 ],
            [ 2.8,  0.08265754107,  5.46e-12 ],
            [ 2.82, 0.08135723830,  5.13e-12 ],
            [ 2.84, 0.08008860619,  4.81e-12 ],
            [ 2.86, 0.07641819812,  4.39e-12 ],
            [ 2.88, 0.07764216931,  4.23e-12 ],
            [ 2.9,  0.07646238274,  3.95e-12 ],
            [ 2.92, 0.07531029871,  3.7e-12 ],
            [ 2.94, 0.07418502683,  3.45e-12 ],
            [ 2.96, 0.07308571330,  3.21e-12 ],
            [ 2.98, 0.07201153905,  2.99e-12 ],
            [ 3,    0.07096171802,  2.78e-12 ],
            [ 3.05, 0.06843883131,  2.29e-12 ],
            [ 3.1,  0.06605251261,  4.4e-11 ],
            [ 3.15, 0.06379279129,  3.82e-11 ],
            [ 3.2,  0.06165061366,  3.3e-11 ],
            [ 3.25, 0.05961774131,  2.84e-11 ],
            [ 3.3,  0.05768666275,  2.42e-11 ],
            [ 3.35, 0.05585051613,  2.05e-11 ],
            [ 3.4,  0.05410302159,  1.72e-11 ],
            [ 3.45, 0.05243842180,  1.43e-11 ],
            [ 3.5,  0.05085142965,  1.16e-11 ],
            [ 3.55, 0.04933718198,  9.27e-12 ],
            [ 3.6,  0.04789119869,  7.15e-12 ],
            [ 3.65, 0.04650934641,  5.24e-12 ],
            [ 3.7,  0.04518780619,  3.53e-12 ],
            [ 3.75, 0.04392304476,  2e-12 ],
            [ 3.8,  0.04271178877,  6.26e-13 ],
            [ 3.85, 0.04155100183,  6.06e-13 ],
            [ 3.9,  0.04043786385,  1.71e-12 ],
            [ 3.95, 0.03936975251,  2.7e-12 ],
            [ 4,    0.03834422658,  3.58e-12 ],
            [ 4.1,  0.03641198275,  5.07e-12 ],
            [ 4.2,  0.03462468813,  4.77e-11 ],
            [ 4.3,  0.03296797170,  2.92e-11 ],
            [ 4.4,  0.03142922556,  1.38e-11 ],
            [ 4.5,  0.02999734835,  1.11e-12 ],
            [ 4.6,  0.02866253158,  9.39e-12 ],
            [ 4.7,  0.02741608098,  1.8e-11 ],
            [ 4.8,  0.02625026624,  2.52e-11 ],
            [ 4.9,  0.02515819410,  3.1e-11 ],
            [ 5,    0.02413370080,  3.57e-11 ],
            [ 5.1,  0.02317126035,  3.96e-11 ],
            [ 5.2,  0.02226590620,  4.26e-11 ],
            [ 5.3,  0.02141316395,  4.5e-11 ],
            [ 5.4,  0.02060899342,  4.69e-11 ],
            [ 5.5,  0.01984973861,  4.83e-11 ],
            [ 5.6,  0.01913208427,  4.93e-11 ],
            [ 5.7,  0.0184530182,   5e-11 ],
            [ 5.8,  0.01780979829,  8.82e-12 ],
            [ 5.9,  0.01668169911,  4.99e-11 ],
            [ 6,    0.01662110998,  8.47e-12 ],
            [ 6.1,  0.01607126611,  8.28e-12 ],
            [ 6.2,  0.0155484757,   5e-11 ],
            [ 6.3,  0.01505097936,  4.95e-11 ],
            [ 6.4,  0.01457715944,  4.9e-11 ],
            [ 6.5,  0.01370067706,  4.79e-11 ],
            [ 6.6,  0.01369470705,  4.77e-11 ],
            [ 6.7,  0.01328343314,  4.7e-11 ],
            [ 6.8,  0.01289053243,  4.62e-11 ],
            [ 6.9,  0.01251491973,  4.54e-11 ],
            [ 7,    0.01215558929,  4.46e-11 ],
        ],
        [
            [ 1.01, 39.3847992397,  5.92e-11 ],
            [ 1.02, 19.74447239709, 2.51e-11 ],
            [ 1.03, 13.19433848894, 1.14e-11 ],
            [ 1.04, 9.9169080078,   8.5e-11 ],
            [ 1.05, 7.94867397525,  4.3e-11 ],
            [ 1.06, 6.63512716814,  2.33e-11 ],
            [ 1.07, 5.69575823437,  1.36e-11 ],
            [ 1.08, 4.99030817602,  8.43e-12 ],
            [ 1.09, 4.4408518079,   8.9e-11 ],
            [ 1.1,  4.0006311125,   6.11e-11 ],
            [ 1.11, 3.63988855955,  4.35e-11 ],
            [ 1.12, 3.33878374802,  3.49e-11 ],
            [ 1.13, 3.08357927385,  2.62e-11 ],
            [ 1.14, 2.86446121367,  2.29e-11 ],
            [ 1.15, 2.67423140412,  1.79e-11 ],
            [ 1.16, 2.50749010754,  1.66e-11 ],
            [ 1.17, 2.36010714108,  1.61e-11 ],
            [ 1.18, 2.22886928963,  1.28e-11 ],
            [ 1.19, 2.11123905667,  1.04e-11 ],
            [ 1.2,  2.00518578512,  8.48e-12 ],
            [ 1.21, 1.90906502540,  6.99e-12 ],
            [ 1.22, 1.8215307996,   9.25e-11 ],
            [ 1.23, 1.7414707503,   7.75e-11 ],
            [ 1.24, 1.6679574997,   6.53e-11 ],
            [ 1.25, 1.6002116798,   5.55e-11 ],
            [ 1.26, 1.53757349278,  4.74e-11 ],
            [ 1.27, 1.47948058918,  4.07e-11 ],
            [ 1.28, 1.42545068477,  3.52e-11 ],
            [ 1.29, 1.37506777296,  3.05e-11 ],
            [ 1.3,  1.32797109331,  2.66e-11 ],
            [ 1.31, 1.28384623417,  2.33e-11 ],
            [ 1.32, 1.24241790264,  2.04e-11 ],
            [ 1.33, 1.20344400825,  1.8e-11 ],
            [ 1.34, 1.16671078996,  1.6e-11 ],
            [ 1.35, 1.13202877784,  1.42e-11 ],
            [ 1.36, 1.09922942728,  1.26e-11 ],
            [ 1.37, 1.06816229842,  1.13e-11 ],
            [ 1.38, 1.03869268045,  1.01e-11 ],
            [ 1.39, 1.01069958104,  9.08e-12 ],
            [ 1.4,  0.98407401688,  8.18e-12 ],
            [ 1.41, 0.95871755415,  7.38e-12 ],
            [ 1.42, 0.93454105707,  6.68e-12 ],
            [ 1.43, 0.9114636109,   9.65e-11 ],
            [ 1.44, 0.8894115913,   8.77e-11 ],
            [ 1.45, 0.8683178582,   7.98e-11 ],
            [ 1.46, 0.8481210535,   7.28e-11 ],
            [ 1.47, 0.8287649894,   6.65e-11 ],
            [ 1.48, 0.8101981122,   6.08e-11 ],
            [ 1.49, 0.7923730319,   5.57e-11 ],
            [ 1.5,  0.7752461085,   5.11e-11 ],
            [ 1.51, 0.75877708561,  4.7e-11 ],
            [ 1.52, 0.74292876794,  4.32e-11 ],
            [ 1.53, 0.72766673368,  3.98e-11 ],
            [ 1.54, 0.71295907955,  3.66e-11 ],
            [ 1.55, 0.69877619339,  3.38e-11 ],
            [ 1.56, 0.68509055093,  3.12e-11 ],
            [ 1.57, 0.67187653398,  2.88e-11 ],
            [ 1.58, 0.65911026734,  2.66e-11 ],
            [ 1.59, 0.64676947218,  2.45e-11 ],
            [ 1.6,  0.63483333408,  2.26e-11 ],
            [ 1.61, 0.62328238396,  2.09e-11 ],
            [ 1.62, 0.61209839049,  1.93e-11 ],
            [ 1.63, 0.60126426270,  1.78e-11 ],
            [ 1.64, 0.59076396166,  1.64e-11 ],
            [ 1.65, 0.58058242031,  1.51e-11 ],
            [ 1.66, 0.57070547050,  1.39e-11 ],
            [ 1.67, 0.56111977655,  1.28e-11 ],
            [ 1.68, 0.55181277464,  1.17e-11 ],
            [ 1.69, 0.54277261744,  1.07e-11 ],
            [ 1.7,  0.53398812341,  9.8e-12 ],
            [ 1.71, 0.52544873048,  8.94e-12 ],
            [ 1.72, 0.51714445342,  8.13e-12 ],
            [ 1.73, 0.50906584479,  7.37e-12 ],
            [ 1.74, 0.50120395899,  6.66e-12 ],
            [ 1.75, 0.49355031921,  6e-12 ],
            [ 1.76, 0.48609688691,  5.39e-12 ],
            [ 1.77, 0.4788360337,   9.6e-11 ],
            [ 1.78, 0.4717605154,   8.85e-11 ],
            [ 1.79, 0.4648634479,   8.16e-11 ],
            [ 1.8,  0.4581382851,   7.52e-11 ],
            [ 1.81, 0.4515787982,   6.94e-11 ],
            [ 1.82, 0.4451790566,   6.41e-11 ],
            [ 1.83, 0.4389334103,   5.93e-11 ],
            [ 1.84, 0.4328364730,   5.49e-11 ],
            [ 1.85, 0.4268831074,   5.1e-11 ],
            [ 1.86, 0.42106841049,  4.76e-11 ],
            [ 1.87, 0.41538770039,  4.46e-11 ],
            [ 1.88, 0.40983650394,  4.2e-11 ],
            [ 1.89, 0.40441054518,  3.98e-11 ],
            [ 1.9,  0.39910573450,  3.8e-11 ],
            [ 1.91, 0.39391815859,  3.65e-11 ],
            [ 1.92, 0.38884407093,  3.55e-11 ],
            [ 1.93, 0.38387988304,  3.48e-11 ],
            [ 1.94, 0.37902215612,  3.44e-11 ],
            [ 1.95, 0.37426759332,  3.44e-11 ],
            [ 1.96, 0.36961303248,  3.48e-11 ],
            [ 1.97, 0.36505543924,  3.54e-11 ],
            [ 1.98, 0.36059190066,  3.64e-11 ],
            [ 1.99, 0.35621961916,  3.77e-11 ],
            [ 2,    0.35193567,     9.36e-08 ],
            [ 2.02, 0.34362395495,  4.33e-11 ],
            [ 2.04, 0.33563654007,  4.85e-11 ],
            [ 2.06, 0.3279556008,   5.47e-11 ],
            [ 2.08, 0.3205643875,   6.19e-11 ],
            [ 2.1,  0.3134473452,   7.01e-11 ],
            [ 2.12, 0.3065900083,   7.91e-11 ],
            [ 2.14, 0.2999789068,   8.9e-11 ],
            [ 2.16, 0.2936014819,   9.97e-11 ],
            [ 2.18, 0.28744600982,  1.41e-11 ],
            [ 2.2,  0.28150153360,  1.6e-11 ],
            [ 2.22, 0.27575780116,  1.8e-11 ],
            [ 2.24, 0.27020520946,  2.02e-11 ],
            [ 2.26, 0.26483475385,  2.24e-11 ],
            [ 2.28, 0.25963798212,  2.48e-11 ],
            [ 2.3,  0.25460695274,  2.72e-11 ],
            [ 2.32, 0.24973419679,  2.97e-11 ],
            [ 2.34, 0.24501268336,  3.23e-11 ],
            [ 2.36, 0.24043578782,  3.49e-11 ],
            [ 2.38, 0.23599726296,  3.77e-11 ],
            [ 2.4,  0.23169121244,  4.04e-11 ],
            [ 2.42, 0.22751206654,  4.33e-11 ],
            [ 2.44, 0.22345455983,  4.61e-11 ],
            [ 2.46, 0.21951371073,  4.91e-11 ],
            [ 2.48, 0.2156848026,   5.2e-11 ],
            [ 2.5,  0.2119633665,   5.5e-11 ],
            [ 2.52, 0.2083451650,   5.8e-11 ],
            [ 2.54, 0.2048261776,   6.1e-11 ],
            [ 2.56, 0.2014025867,   6.4e-11 ],
            [ 2.58, 0.1980707656,   6.71e-11 ],
            [ 2.6,  0.1948272660,   7.01e-11 ],
            [ 2.62, 0.1916688079,   7.32e-11 ],
            [ 2.64, 0.1885922689,   7.62e-11 ],
            [ 2.66, 0.1855946753,   7.93e-11 ],
            [ 2.68, 0.1826731932,   8.23e-11 ],
            [ 2.7,  0.1798251203,   8.53e-11 ],
            [ 2.72, 0.1770478787,   8.83e-11 ],
            [ 2.74, 0.1743390076,   9.13e-11 ],
            [ 2.76, 0.1716961567,   9.42e-11 ],
            [ 2.78, 0.1691170804,   9.71e-11 ],
            [ 2.8,  0.16659963171,  1.7e-11 ],
            [ 2.82, 0.16414175723,  1.76e-11 ],
            [ 2.84, 0.16174149193,  1.81e-11 ],
            [ 2.86, 0.15939695452,  1.87e-11 ],
            [ 2.88, 0.15710634313,  1.92e-11 ],
            [ 2.9,  0.15486793109,  1.98e-11 ],
            [ 2.92, 0.15268006315,  2.03e-11 ],
            [ 2.94, 0.15054115182,  2.08e-11 ],
            [ 2.96, 0.14844967395,  2.14e-11 ],
            [ 2.98, 0.14640416754,  2.19e-11 ],
            [ 3,    0.14440322873,  2.24e-11 ],
            [ 3.05, 0.13958714375,  2.37e-11 ],
            [ 3.1,  0.13502163806,  2.49e-11 ],
            [ 3.15, 0.13068885208,  2.61e-11 ],
            [ 3.2,  0.12657254536,  2.72e-11 ],
            [ 3.25, 0.12265791865,  2.82e-11 ],
            [ 3.3,  0.11893145892,  2.92e-11 ],
            [ 3.35, 0.11538080390,  3.02e-11 ],
            [ 3.4,  0.11199462330,  3.11e-11 ],
            [ 3.45, 0.10876251446,  3.19e-11 ],
            [ 3.5,  0.10567491029,  3.27e-11 ],
            [ 3.55, 0.10272299797,  3.34e-11 ],
            [ 3.6,  0.09989864692,  3.41e-11 ],
            [ 3.65, 0.09719434482,  3.47e-11 ],
            [ 3.7,  0.09460314063,  3.53e-11 ],
            [ 3.75, 0.09211859382,  3.58e-11 ],
            [ 3.8,  0.08973472900,  3.63e-11 ],
            [ 3.85, 0.08744599516,  3.68e-11 ],
            [ 3.9,  0.08524722924,  3.71e-11 ],
            [ 3.95, 0.08313362328,  3.75e-11 ],
            [ 4,    0.08110069486,  3.78e-11 ],
            [ 4.1,  0.07726041108,  3.83e-11 ],
            [ 4.2,  0.07369607721,  3.86e-11 ],
            [ 4.3,  0.07038113673,  3.89e-11 ],
            [ 4.4,  0.06729222500,  3.9e-11 ],
            [ 4.5,  0.06440871112,  3.9e-11 ],
            [ 4.6,  0.06171231595,  3.89e-11 ],
            [ 4.7,  0.05918679194,  3.87e-11 ],
            [ 4.8,  0.05681765334,  3.85e-11 ],
            [ 4.9,  0.05459194798,  3.82e-11 ],
            [ 5,    0.05249806329,  3.78e-11 ],
            [ 5.1,  0.05052556069,  3.74e-11 ],
            [ 5.2,  0.04866503377,  3.69e-11 ],
            [ 5.3,  0.04690798632,  3.65e-11 ],
            [ 5.4,  0.04524672704,  3.6e-11 ],
            [ 5.5,  0.04367427839,  3.54e-11 ],
            [ 5.6,  0.04218429740,  3.49e-11 ],
            [ 5.7,  0.04077100669,  3.43e-11 ],
            [ 5.8,  0.03942913417,  3.37e-11 ],
            [ 5.9,  0.03815386020,  3.31e-11 ],
            [ 6,    0.03694077117,  3.26e-11 ],
            [ 6.1,  0.03578581860,  3.2e-11 ],
            [ 6.2,  0.03468528300,  3.14e-11 ],
            [ 6.3,  0.03363574193,  3.08e-11 ],
            [ 6.4,  0.03263404161,  3.02e-11 ],
            [ 6.5,  0.03167727171,  2.96e-11 ],
            [ 6.6,  0.03076274288,  2.9e-11 ],
            [ 6.7,  0.02988796667,  2.84e-11 ],
            [ 6.8,  0.02905063758,  2.78e-11 ],
            [ 6.9,  0.02824861701,  2.73e-11 ],
            [ 7,    0.02747991875,  2.67e-11 ],
        ],
        [
            [ 1.01, 33.60911049161, 1.44e-11 ],
            [ 1.02, 16.85006450652, 1.8e-11 ],
            [ 1.03, 11.26127133432, 9.89e-12 ],
            [ 1.04, 8.4651433172,   6.91e-11 ],
            [ 1.05, 6.78615758472,  3.51e-11 ],
            [ 1.06, 5.66580241236,  1.91e-11 ],
            [ 1.07, 4.86471238790,  1.11e-11 ],
            [ 1.08, 4.26320218193,  6.86e-12 ],
            [ 1.09, 3.7947777877,   6.9e-11 ],
            [ 1.1,  3.41954100306,  4.93e-11 ],
            [ 1.11, 3.11210054775,  3.5e-11 ],
            [ 1.12, 2.85552761236,  2.81e-11 ],
            [ 1.13, 2.63810114639,  2.1e-11 ],
            [ 1.14, 2.45144801632,  1.85e-11 ],
            [ 1.15, 2.28942709493,  1.43e-11 ],
            [ 1.16, 2.14743181245,  1.33e-11 ],
            [ 1.17, 2.02193886218,  1.28e-11 ],
            [ 1.18, 1.91020733413,  1.02e-11 ],
            [ 1.19, 1.81007285610,  8.19e-12 ],
            [ 1.2,  1.71980348995,  6.66e-12 ],
            [ 1.21, 1.6379967981,   8.71e-11 ],
            [ 1.22, 1.5635049809,   7.21e-11 ],
            [ 1.23, 1.4953795415,   6.01e-11 ],
            [ 1.24, 1.4328297836,   5.05e-11 ],
            [ 1.25, 1.37519126752,  4.27e-11 ],
            [ 1.26, 1.32190154541,  3.63e-11 ],
            [ 1.27, 1.27248128694,  3.1e-11 ],
            [ 1.28, 1.22651944897,  2.67e-11 ],
            [ 1.29, 1.18366151262,  2.31e-11 ],
            [ 1.3,  1.14360007222,  2e-11 ],
            [ 1.31, 1.10606724513,  1.74e-11 ],
            [ 1.32, 1.07082850418,  1.53e-11 ],
            [ 1.33, 1.03767763092,  1.34e-11 ],
            [ 1.34, 1.00643255908,  1.18e-11 ],
            [ 1.35, 0.97693193010,  1.04e-11 ],
            [ 1.36, 0.94903222244,  9.25e-12 ],
            [ 1.37, 0.92260534603,  8.23e-12 ],
            [ 1.38, 0.89753661624,  7.34e-12 ],
            [ 1.39, 0.87372303933,  6.56e-12 ],
            [ 1.4,  0.8510718548,   9.37e-11 ],
            [ 1.41, 0.8294992907,   8.41e-11 ],
            [ 1.42, 0.8089294969,   7.57e-11 ],
            [ 1.43, 0.7892936267,   6.83e-11 ],
            [ 1.44, 0.7705290436,   6.17e-11 ],
            [ 1.45, 0.7525786336,   5.58e-11 ],
            [ 1.46, 0.7353902074,   5.05e-11 ],
            [ 1.47, 0.71891597831,  4.58e-11 ],
            [ 1.48, 0.70311210574,  4.16e-11 ],
            [ 1.49, 0.68793829408,  3.77e-11 ],
            [ 1.5,  0.67335743998,  3.42e-11 ],
            [ 1.51, 0.65933532077,  3.11e-11 ],
            [ 1.52, 0.64584031895,  2.82e-11 ],
            [ 1.53, 0.63284317762,  2.56e-11 ],
            [ 1.54, 0.62031678316,  2.32e-11 ],
            [ 1.55, 0.60823597144,  2.1e-11 ],
            [ 1.56, 0.59657735484,  1.89e-11 ],
            [ 1.57, 0.58531916733,  1.71e-11 ],
            [ 1.58, 0.57444112556,  1.54e-11 ],
            [ 1.59, 0.56392430409,  1.38e-11 ],
            [ 1.6,  0.55375102293,  1.23e-11 ],
            [ 1.61, 0.54390474625,  1.1e-11 ],
            [ 1.62, 0.53436999071,  9.81e-12 ],
            [ 1.63, 0.52513224260,  8.73e-12 ],
            [ 1.64, 0.51617788267,  7.76e-12 ],
            [ 1.65, 0.50749411784,  6.92e-12 ],
            [ 1.66, 0.49906891917,  6.19e-12 ],
            [ 1.67, 0.49089096527,  5.58e-12 ],
            [ 1.68, 0.48294959077,  5.09e-12 ],
            [ 1.69, 0.4752347392,   9.98e-11 ],
            [ 1.7,  0.4677369197,   9.43e-11 ],
            [ 1.71, 0.4604471680,   9.02e-11 ],
            [ 1.72, 0.4533570098,   8.74e-11 ],
            [ 1.73, 0.4464584275,   8.59e-11 ],
            [ 1.74, 0.4397438301,   8.57e-11 ],
            [ 1.75, 0.4332060247,   8.68e-11 ],
            [ 1.76, 0.4268381904,   8.92e-11 ],
            [ 1.77, 0.4206338549,   9.29e-11 ],
            [ 1.78, 0.4145868721,   9.78e-11 ],
            [ 1.79, 0.40869140168,  9.01e-12 ],
            [ 1.8,  0.40294189016,  1.03e-11 ],
            [ 1.81, 0.39733305361,  1.18e-11 ],
            [ 1.82, 0.39185986120,  1.35e-11 ],
            [ 1.83, 0.38651752023,  1.54e-11 ],
            [ 1.84, 0.38130146208,  1.74e-11 ],
            [ 1.85, 0.37620732923,  1.97e-11 ],
            [ 1.86, 0.37123096308,  2.21e-11 ],
            [ 1.87, 0.36636839273,  2.47e-11 ],
            [ 1.88, 0.36161582440,  2.76e-11 ],
            [ 1.89, 0.35696963162,  3.06e-11 ],
            [ 1.9,  0.35242634608,  3.38e-11 ],
            [ 1.91, 0.34798264901,  3.72e-11 ],
            [ 1.92, 0.34363536320,  4.08e-11 ],
            [ 1.93, 0.33938144546,  4.46e-11 ],
            [ 1.94, 0.33521797964,  4.86e-11 ],
            [ 1.95, 0.3311421700,   5.28e-11 ],
            [ 1.96, 0.3271513349,   5.72e-11 ],
            [ 1.97, 0.3232429014,   6.17e-11 ],
            [ 1.98, 0.3194143993,   6.65e-11 ],
            [ 1.99, 0.3156634562,   7.14e-11 ],
            [ 2,    0.31198771,     2.38e-07 ],
            [ 2.02, 0.3048536274,   8.71e-11 ],
            [ 2.04, 0.2979953626,   9.84e-11 ],
            [ 2.06, 0.29139768325,  1.8e-11 ],
            [ 2.08, 0.28504638601,  2.03e-11 ],
            [ 2.1,  0.27892828037,  2.27e-11 ],
            [ 2.12, 0.27303109947,  2.52e-11 ],
            [ 2.14, 0.26734342041,  2.79e-11 ],
            [ 2.16, 0.26185459259,  3.06e-11 ],
            [ 2.18, 0.25655467333,  3.34e-11 ],
            [ 2.2,  0.25143436981,  3.64e-11 ],
            [ 2.22, 0.24648498669,  3.93e-11 ],
            [ 2.24, 0.24169837868,  4.24e-11 ],
            [ 2.26, 0.23706690766,  4.55e-11 ],
            [ 2.28, 0.23258340365,  4.86e-11 ],
            [ 2.3,  0.2282411295,   5.18e-11 ],
            [ 2.32, 0.2240337485,   5.5e-11 ],
            [ 2.34, 0.2199552951,   5.82e-11 ],
            [ 2.36, 0.2160001483,   6.14e-11 ],
            [ 2.38, 0.2121630066,   6.45e-11 ],
            [ 2.4,  0.2084388659,   6.77e-11 ],
            [ 2.42, 0.2048229991,   7.08e-11 ],
            [ 2.44, 0.2013109367,   7.39e-11 ],
            [ 2.46, 0.1978984499,   7.69e-11 ],
            [ 2.48, 0.1945815344,   7.98e-11 ],
            [ 2.5,  0.1913563957,   8.27e-11 ],
            [ 2.52, 0.1882194356,   8.55e-11 ],
            [ 2.54, 0.1851672397,   8.83e-11 ],
            [ 2.56, 0.1821965658,   9.09e-11 ],
            [ 2.58, 0.1793043330,   9.35e-11 ],
            [ 2.6,  0.1764876120,   9.59e-11 ],
            [ 2.62, 0.1737436160,   9.83e-11 ],
            [ 2.64, 0.17106969185,  2.08e-11 ],
            [ 2.66, 0.16846331241,  2.13e-11 ],
            [ 2.68, 0.16592206900,  2.18e-11 ],
            [ 2.7,  0.16344366463,  2.23e-11 ],
            [ 2.72, 0.16102590761,  2.28e-11 ],
            [ 2.74, 0.15866670559,  2.33e-11 ],
            [ 2.76, 0.15636406001,  2.37e-11 ],
            [ 2.78, 0.15411606091,  2.41e-11 ],
            [ 2.8,  0.15192088211,  2.44e-11 ],
            [ 2.82, 0.14977677667,  2.48e-11 ],
            [ 2.84, 0.14768207265,  2.51e-11 ],
            [ 2.86, 0.14563516913,  2.54e-11 ],
            [ 2.88, 0.14363453253,  2.56e-11 ],
            [ 2.9,  0.14167869308,  2.59e-11 ],
            [ 2.92, 0.13976624159,  2.61e-11 ],
            [ 2.94, 0.13789582634,  2.62e-11 ],
            [ 2.96, 0.13606615020,  2.63e-11 ],
            [ 2.98, 0.13427596794,  2.64e-11 ],
            [ 3,    0.13252408365,  2.65e-11 ],
            [ 3.05, 0.12830449562,  2.66e-11 ],
            [ 3.1,  0.12430043584,  2.64e-11 ],
            [ 3.15, 0.12049667762,  2.61e-11 ],
            [ 3.2,  0.11687936897,  2.56e-11 ],
            [ 3.25, 0.11343588184,  2.49e-11 ],
            [ 3.3,  0.11015468079,  2.4e-11 ],
            [ 3.35, 0.1070252081,   9.82e-11 ],
            [ 3.4,  0.1040377833,   9.27e-11 ],
            [ 3.45, 0.1011835141,   8.67e-11 ],
            [ 3.5,  0.0984542193,   8.02e-11 ],
            [ 3.55, 0.0958423589,   7.34e-11 ],
            [ 3.6,  0.0933409736,   6.62e-11 ],
            [ 3.65, 0.0909436301,   5.87e-11 ],
            [ 3.7,  0.0886443732,   5.08e-11 ],
            [ 3.75, 0.08643768224,  4.28e-11 ],
            [ 3.8,  0.08431843297,  3.45e-11 ],
            [ 3.85, 0.08228186275,  2.61e-11 ],
            [ 3.9,  0.0803235397,   7.02e-11 ],
            [ 3.95, 0.07843933458,  3.51e-11 ],
            [ 4,    0.07662539608,  1.18e-11 ],
            [ 4.1,  0.0731941678,   6.99e-11 ],
            [ 4.2,  0.07000378832,  3.53e-11 ],
            [ 4.3,  0.0670313895,   5.28e-11 ],
            [ 4.4,  0.0642568319,   7e-11 ],
            [ 4.5,  0.0616623146,   8.67e-11 ],
            [ 4.6,  0.05923205020,  2.68e-11 ],
            [ 4.7,  0.05695199206,  3.1e-11 ],
            [ 4.8,  0.05480960429,  3.5e-11 ],
            [ 4.9,  0.05279366716,  3.89e-11 ],
            [ 5,    0.05089411157,  4.26e-11 ],
            [ 5.1,  0.04910187774,  4.6e-11 ],
            [ 5.2,  0.04740879404,  4.92e-11 ],
            [ 5.3,  0.0458074728,   5.21e-11 ],
            [ 5.4,  0.0442912203,   5.48e-11 ],
            [ 5.5,  0.0428539589,   5.71e-11 ],
            [ 5.6,  0.0414901593,   5.92e-11 ],
            [ 5.7,  0.0401947813,   6.09e-11 ],
            [ 5.8,  0.0389632228,   6.22e-11 ],
            [ 5.9,  0.0377912740,   6.31e-11 ],
            [ 6,    0.0366750785,   6.35e-11 ],
            [ 6.1,  0.0356110977,   6.33e-11 ],
            [ 6.2,  0.0345960810,   6.24e-11 ],
            [ 6.3,  0.0336270383,   6.07e-11 ],
            [ 6.4,  0.0327012167,   5.77e-11 ],
            [ 6.5,  0.0318160802,   5.31e-11 ],
            [ 6.6,  0.03096929192,  4.63e-11 ],
            [ 6.7,  0.03015870055,  3.65e-11 ],
            [ 6.8,  0.02938233073,  2.31e-11 ],
            [ 6.9,  0.0286383830,   9.42e-11 ],
            [ 7,    0.02792526803,  4.86e-17 ],
        ],
    ];
}

sub alpha_interpolate {
    my ( $sym, $gamma ) = @_;

    # Given: a 1d symmetry (0, 1, or 2) and an ideal gas gamma
    # return: parameter alpha for the similarity solution
    # returns undef if out of bounds of table
    # (currently gamma<1.1 || $gamma>7 )

    # alpha is obtained by interpolating a table of pre-computed values.
    # The table is spaced closely enough that cubic interpolation of the
    # interpolated values gives comparable accuracy to the tabulated values
    # (error below about 1.e-7 over most of the range).

    return if ( $sym != 0 && $sym != 1 && $sym != 2 );

    my $rtab = $ralpha_table->[$sym];
    my $ntab = @{$rtab};
    my ( $jl, $ju );
    my $icol = 0;

    # A small tolerance to avoid interpolations
    my $eps = 1.e-6;

    ( $jl, $ju ) = locate_2d( $gamma, $icol, $rtab, $jl, $ju );
    my ( $gamma_min, $alpha_min ) = @{ $rtab->[0] };
    my ( $gamma_max, $alpha_max ) = @{ $rtab->[1] };
    if ( $jl < 0 ) {
        return if ( $gamma + $eps < $gamma_min );
        return $alpha_min;
    }
    if ( $ju >= $ntab ) {
        return if ( $gamma - $eps > $gamma_max );
        return $alpha_max;
    }

    # Define N consecutive lagrange interpolation points;
    # Using 4 points gives sufficient accuracy
    my $NLAG = 4;
    my $rj_interp = set_interpolation_points( $jl, $ntab, $NLAG );

    my ( $rx, $ry );

    # alpha varies approximately as 1/{ (gamma-1)*sqrt(gamma+1) },
    # so we can improve accuracy by interpolating the function
    # alpha*(gamma-1)*sqrt(gamma+1)
    foreach my $jj ( @{$rj_interp} ) {
        my ( $xx, $yy ) = @{ $rtab->[$jj] };
        push @{$rx}, $xx;
        push @{$ry}, $yy * ( $xx - 1 ) * sqrt( $xx + 1 );
    }

    my $ff = polint( $gamma, $rx, $ry );
    my $alpha = $ff / ( ( $gamma - 1 ) * sqrt( $gamma + 1 ) );

    return ($alpha);
}
1;
