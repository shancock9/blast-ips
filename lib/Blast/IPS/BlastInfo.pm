package Blast::IPS::BlastInfo;

# MIT License
# Copyright (c) 2018 Steven Hancock
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.

use strict;
use warnings;
use 5.006;

use Carp;
use Exporter 'import';
use vars qw(@EXPORT_OK);
@EXPORT_OK = qw(get_blast_info);

#####################################
# Tables of General Blast Parameters 
#####################################

my $rpc_table;
my @vnames;

BEGIN {

# Created with: ./FD_to_BlastInfo.pl 
# Sat Jun 23 07:25:04 2018   Inspiron-3668

@vnames = qw(
symmetry
gamma
t_pcenter_zero_1
t_pcenter_zero_2
t_pcenter_min
pcenter_min
t_pcenter_max_2
pcenter_max_2
impulse_center_pos
impulse_center_neg
t_u_plus_c_zero
dpdt_center_max
t_dpdt_center_max
pcenter_dpdt_center_max
Sintegral_pos
Sintegral_neg
);

my $rdata=[
[0, 1.1, 0.23931576, 0, 0.41110101, -0.012996836, 0, 0, 0.12259296, -0.018461078, 0.69911419, 0.016406249, 0.56965301, -0.011084443, 0.10156641, 0, ],
[0, 1.12, 0.29695966, 0, 0.50690293, -0.011143952, 0, 0, 0.14415168, -0.021869047, 0.91556416, 0.011234005, 0.70126911, -0.0095367162, 0.11801697, 0, ],
[0, 1.15, 0.39380129, 0, 0.66729642, -0.0087840532, 0, 0, 0.17578305, -0.023000808, 1.3132903, 0.0065694167, 0.92140886, -0.0075519762, 0.14168844, 0, ],
[0, 1.17, 0.46626219, 0, 0.78693169, -0.0074537162, 0, 0, 0.19633598, -0.023203091, 1.637647, 0.0046489112, 1.0864495, -0.0064248239, 0.15661622, 0, ],
[0, 1.2, 0.58941202, 0, 0.99085162, -0.0057693125, 0, 0, 0.22643084, -0.020012676, 2.2386317, 0.0027855519, 1.3688493, -0.004989533, 0.17697248, 0, ],
[0, 1.23, 0.73433423, 0, 1.2326143, -0.0044045104, 0, 0, 0.25580292, -0.021831962, 3.0210714, 0.0016653099, 1.7063155, -0.0038186008, 0.19756671, 0, ],
[0, 1.25, 0.84626432, 0, 1.4204978, -0.0036465714, 0, 0, 0.2750574, -0.020886579, 3.6772206, 0.0011750898, 1.9708764, -0.0031657852, 0.21005863, 0, ],
[0, 1.3, 1.2005742, 0, 2.0254571, -0.0021902187, 0, 0, 0.3223203, -0.014630836, 6.0195959, 0.0004737795, 2.8316302, -0.0019055604, 0.23946018, 0, ],
[0, 1.35, 1.7210225, 0, 2.9363151, -0.0012287943, 0, 0, 0.36872183, -0.014204225, 10.066313, 0.00017619695, 4.1454364, -0.0010698297, 0.26636471, 0, ],
[0, 1.4, 2.5507734, 0, 4.4214819, -0.00062803517, 0, 0, 0.41466976, -0.0073452423, 17.618808, 5.7918539e-05, 6.2986743, -0.00054683423, 0.29113661, 0, ],
[0, 1.45, 4.0234685, 0, 7.0864523, -0.00028081097, 0, 0, 0.46051706, -0.0067747534, 33.303021, 1.578049e-05, 10.169383, -0.00024448428, 0.31415123, 0, ],
[0, 1.5, 7.0511211, 0, 12.579076, -0.00010204221, 0, 0, 0.50658446, -0.003648409, 71.571739, 3.1812274e-06, 18.150184, -8.8807299e-05, 0.33571254, 0, ],
[0, 1.55, 14.902467, 0, 26.806224, -2.5778866e-05, 0, 0, 0.55317859, -0.0013223126, 0, 3.7432215e-07, 38.798316, -2.2425079e-05, 0.35605255, 0, ],
[0, 1.6, 47.381008, 0, 85.428169, -2.9383769e-06, 0, 0, 0.60061315, -0.00010314757, 0, 5.6035983e-09, 91.507303, -2.9200845e-06, 0.37538407, 0, ],
[0, 1.65, 0, 0, 0, 0, 0, 0, 0.6489038, 0, 0, 0, 0, 0, 0.39380256, 0, ],
[0, 1.667, 0, 0, 0, 0, 0, 0, 0.66274558, 0, 0, 0, 0, 0, 0, 0, ],
[0, 1.7, 0, 0, 0, 0, 0, 0, 0.69704487, 0, 0, 0, 0, 0, 0.41108974, 0, ],
[0, 1.8, 0, 0, 0, 0, 0, 0, 0.79259766, 0, 0, 0, 0, 0, 0.44256641, 0, ],
[0, 1.9, 0, 0, 0, 0, 0, 0, 0.88722537, 0, 0, 0, 0, 0, 0.47048061, 0, ],
[0, 2, 0, 0, 0, 0, 0, 0, 0.97508697, 0, 0, 0, 0, 0, 0.49369632, 0, ],
[0, 2.2, 0, 0, 0, 0, 0, 0, 1.166088, 0, 0, 0, 0, 0, 0.5370386, 0, ],
[0, 2.5, 0, 0, 0, 0, 0, 0, 1.4383435, 0, 0, 0, 0, 0, 0, 0, ],
[0, 3, 0, 0, 0, 0, 0, 0, 1.8799196, 0, 0, 0, 0, 0, 0, 0, ],
[0, 3.5, 0, 0, 0, 0, 0, 0, 2.3089594, 0, 0, 0, 0, 0, 0, 0, ],
[0, 4, 0, 0, 0, 0, 0, 0, 2.7275393, 0, 0, 0, 0, 0, 0, 0, ],
[0, 4.5, 0, 0, 0, 0, 0, 0, 3.1371825, 0, 0, 0, 0, 0, 0, 0, ],
[0, 5, 0, 0, 0, 0, 0, 0, 3.5389992, 0, 0, 0, 0, 0, 0, 0, ],
[0, 5.5, 0, 0, 0, 0, 0, 0, 3.9338399, 0, 0, 0, 0, 0, 0, 0, ],
[0, 6, 0, 0, 0, 0, 0, 0, 4.3223761, 0, 0, 0, 0, 0, 0, 0, ],
[0, 6.5, 0, 0, 0, 0, 0, 0, 4.7051518, 0, 0, 0, 0, 0, 0, 0, ],
[0, 7, 0, 0, 0, 0, 0, 0, 5.5421057, 0, 0, 0, 0, 0, 0, 0, ],
[1, 1.1, 0.11620959, 0, 0.2503581, -0.13880572, 0, 0, 0.72632085, -0.069043802, 0.30140926, 0.3283474, 0.39568925, -0.10434902, 0.027385852, 0, ],
[1, 1.12, 0.1249944, 0, 0.26991355, -0.13903772, 0, 0, 0.7804261, -0.075566696, 0.32980693, 0.30215971, 0.42685701, -0.10477557, 0.030627675, 0, ],
[1, 1.15, 0.13626823, 0, 0.29529238, -0.13945859, 0, 0, 0.8496962, -0.084315286, 0.36772555, 0.27322572, 0.46734736, -0.10547685, 0.035017617, 0, ],
[1, 1.17, 0.14271805, 0, 0.31002615, -0.13978202, 0, 0, 0.88924946, -0.089665268, 0.39028327, 0.25856851, 0.49096318, -0.105942, 0.037627336, 0, ],
[1, 1.2, 0.15115126, 0, 0.32951806, -0.14032314, 0, 0, 0.94090457, -0.096979762, 0.42083155, 0.2411158, 0.5223914, -0.1066622, 0.041197343, 0, ],
[1, 1.23, 0.15838655, 0, 0.34651042, -0.140923, 0, 0, 0.98519408, -0.10408125, 0.44809486, 0.22746146, 0.54990177, -0.10742212, 0.044378637, 0, ],
[1, 1.25, 0.16266424, 0, 0.35672485, -0.14135151, 0, 0, 1.011382, -0.10847233, 0.46472186, 0.21988559, 0.56649032, -0.10793947, 0.046329, 0, ],
[1, 1.3, 0.17182027, 0, 0.37910374, -0.14250828, 0, 0, 1.0675002, -0.11856702, 0.50175221, 0.20473997, 0.60313369, -0.10924282, 0.050681067, 0, ],
[1, 1.35, 0.17923298, 0, 0.39781826, -0.14376675, 0, 0, 1.1130885, -0.12833731, 0.53341254, 0.19338918, 0.63413873, -0.11059314, 0.054425232, 0, ],
[1, 1.4, 0.18530677, 0, 0.41370067, -0.14510643, 0, 0, 1.1506595, -0.13715112, 0.5607292, 0.18458481, 0.66077673, -0.11198215, 0.057685323, 0, ],
[1, 1.45, 0.19032401, 0, 0.42742728, -0.14651133, 0, 0, 1.1819144, -0.14581874, 0.5844514, 0.17758129, 0.6840239, -0.11338635, 0.060517314, 0, ],
[1, 1.49, 0.19371701, 0, 0.43703436, -0.14767368, 0, 0, 1.2032458, -0.15234866, 0.6012278, 0.17294975, 0.70055569, -0.11452836, 0.062547516, 0, ],
[1, 1.5, 0.19474452, 0, 0.4398703, -0.14796888, 0, 0, 1.2100007, -0.15414758, 0.60593935, 0.17167862, 0.70541813, -0.11480573, 0.063153988, 0, ],
[1, 1.51, 0.1952356, 0, 0.44155135, -0.14826576, 0, 0, 1.2128377, -0.15553313, 0.60896539, 0.17089634, 0.70814598, -0.1151179, 0.063487474, 0, ],
[1, 1.55, 0.19795968, 0, 0.44963585, -0.149469, 0, 0, 1.2302197, -0.16175777, 0.62326482, 0.16723098, 0.72264503, -0.11624147, 0.065183974, 0, ],
[1, 1.6, 0.20085138, 0, 0.45884809, -0.15100366, 0, 0, 1.2489497, -0.16929751, 0.63915761, 0.16334222, 0.73871864, -0.11770941, 0.067224792, 0, ],
[1, 1.65, 0.20325896, 0, 0.46691947, -0.15256618, 0, 0, 1.2648147, -0.17660367, 0.65311948, 0.16007546, 0.7532906, -0.11916028, 0.068998977, 0, ],
[1, 1.667, 0.20398097, 0, 0.46946065, -0.1531028, 0, 0, 1.2696426, -0.17827988, 0.65747062, 0.15908435, 0.75792189, -0.11965331, 0.069568867, 0, ],
[1, 1.7, 0.20525711, 0, 0.47407847, -0.15415117, 0, 0, 1.2782794, -0.18370548, 0.66539115, 0.15731156, 0.76644388, -0.12061669, 0.070586245, 0, ],
[1, 1.8, 0.20825668, 0, 0.48621917, -0.15737146, 0, 0, 1.2993694, -0.19738671, 0.68564255, 0.15295102, 0.78911321, -0.1235545, 0.073334978, 0, ],
[1, 1.9, 0.21021786, 0, 0.49592518, -0.16063695, 0, 0, 1.314371, -0.21048557, 0.70119377, 0.1497517, 0.80797113, -0.12649623, 0.075587923, 0, ],
[1, 2, 0.211397, 0, 0.50379894, -0.16392816, 0, 0, 1.3247718, -0.22118894, 0.71299196, 0.14739202, 0.82394895, -0.12941628, 0.077440671, 0, ],
[1, 2.2, 0.21209743, 0, 0.51538234, -0.17053545, 0, 0, 1.3357134, -0.24717811, 0.72803675, 0.14440277, 0.84902842, -0.13523853, 0.080213317, 0, ],
[1, 2.5, 0.21058629, 0, 0.52571438, -0.18039064, 0, 0, 1.3366515, -0.27970034, 0.73592939, 0.14258201, 0.87506655, -0.14383221, 0.083034758, 0, ],
[1, 3, 0.20486776, 0, 0.53285072, -0.19641303, 0, 0, 1.3176824, -0.3189786, 0.72690171, 0.14312481, 0.90071517, -0.15765964, 0.08551964, 0, ],
[1, 3.5, 0.19775851, 0, 0.53355609, -0.21177787, 0, 0, 1.288085, -0.38179046, 0.70394957, 0.14571201, 0.91449902, -0.1708337, 0.086462207, 0, ],
[1, 4, 0.19047075, 0, 0.53138933, -0.22644399, 0, 0, 1.2552216, -0.42745564, 0.67460571, 0.1491726, 0.92175469, -0.18342257, 0.086632977, 0, ],
[1, 4.5, 0.1834552, 0, 0.52805992, -0.24042426, 0, 0, 1.222022, -0.47086905, 0.64241771, 0.15299353, 0.92577328, -0.19538474, 0.086426748, 0, ],
[1, 5, 0.17687199, 0, 0.52389278, -0.25374973, 0, 0, 1.1897432, -0.5124018, 0.60921374, 0.15692036, 0.92803905, -0.20675501, 0.085966528, 0, ],
[1, 5.5, 0.17076167, 0, 0.51979849, -0.26645721, 0, 0, 1.1589055, -0.55231774, 0.576023, 0.1608173, 0.92888643, -0.21764904, 0.085431983, 0, ],
[1, 6, 0.16511447, 0, 0.51551733, -0.27858455, 0, 0, 1.1296898, -0.59081497, 0.54347932, 0.16460915, 0.92944341, -0.22800085, 0.084777661, 0, ],
[1, 6.5, 0.15990032, 0, 0.51159738, -0.29016855, 0, 0, 1.1021165, -0.62804833, 0.51201194, 0.168254, 0.92976027, -0.23788105, 0.084134355, 0, ],
[1, 7, 0.15508241, 0, 0.50771445, -0.30124418, 0, 0, 1.0761297, -0.66414267, 0.48193114, 0.17172963, 0.92993572, -0.24733344, 0.083440649, 0, ],
[2, 1.1, 0.12795606, 0.93076261, 0.2726629, -0.19190606, 1.1392837, 0.0039531505, 2.9158309, -0.070818764, 0.31346722, 0.50196174, 0.44556117, -0.12974821, 0.016739491, -0.018213781, ],
[2, 1.12, 0.13369536, 0.98788457, 0.28606275, -0.1939018, 1.2080796, 0.0037986787, 3.0477731, -0.075647774, 0.33252495, 0.47938916, 0.46827428, -0.13131982, 0.0185088, -0.020093086, ],
[2, 1.15, 0.14047979, 1.0623341, 0.30240828, -0.19693419, 1.2976627, 0.0035863177, 3.2045029, -0.082142854, 0.35655843, 0.45492572, 0.49634683, -0.1337039, 0.020831443, -0.022543139, ],
[2, 1.17, 0.14409705, 1.1063848, 0.31148224, -0.19897879, 1.3504024, 0.0034561824, 3.2885701, -0.086109318, 0.37025691, 0.44273759, 0.51214479, -0.13528123, 0.022202328, -0.023980252, ],
[2, 1.2, 0.14850503, 1.1661529, 0.32293695, -0.20207602, 1.4217006, 0.0032760247, 3.3917411, -0.091658675, 0.3881112, 0.42858103, 0.53245131, -0.13768398, 0.024044088, -0.025899363, ],
[2, 1.23, 0.15196047, 1.2199638, 0.33250735, -0.20520545, 1.4860429, 0.0031118032, 3.4734582, -0.096839318, 0.40336997, 0.4179451, 0.5496372, -0.14009504, 0.025672464, -0.027584928, ],
[2, 1.25, 0.15384231, 1.2531666, 0.33801125, -0.2073076, 1.5254978, 0.0030101688, 3.5184322, -0.10013189, 0.41235882, 0.4122931, 0.55973526, -0.14169494, 0.026658225, -0.028600035, ],
[2, 1.3, 0.15739511, 1.3287381, 0.34930477, -0.21261118, 1.6151814, 0.0027799119, 3.6048765, -0.10792771, 0.43148504, 0.40179621, 0.58110032, -0.14573456, 0.02883371, -0.030825705, ],
[2, 1.35, 0.15968713, 1.3959419, 0.35801267, -0.21797342, 1.6948563, 0.0025786476, 3.662788, -0.11524955, 0.44679851, 0.39499303, 0.59833073, -0.14975514, 0.030672909, -0.032691028, ],
[2, 1.4, 0.16105123, 1.4567229, 0.36467323, -0.22338417, 1.7667281, 0.0024013329, 3.6997648, -0.12222232, 0.45915894, 0.39071403, 0.61229082, -0.15383103, 0.032246281, -0.034274253, ],
[2, 1.45, 0.16171267, 1.5123986, 0.36981158, -0.22883552, 1.8325778, 0.0022440642, 3.7202771, -0.12892814, 0.46916766, 0.3882476, 0.62386453, -0.15789304, 0.033604658, -0.03563143, ],
[2, 1.5, 0.16183083, 1.5639049, 0.37378476, -0.23432143, 1.8935007, 0.0021037428, 3.7284028, -0.13542369, 0.47726353, 0.38713344, 0.63339503, -0.16200266, 0.0347861, -0.036804057, ],
[2, 1.55, 0.16152246, 1.6119339, 0.37678957, -0.2398371, 1.9503888, 0.0019779009, 3.7265555, -0.14174975, 0.48377863, 0.38705833, 0.64146755, -0.1660755, 0.035819966, -0.037823937, ],
[2, 1.6, 0.16087533, 1.6570119, 0.37902484, -0.24537877, 2.0036232, 0.0018645358, 3.7166874, -0.14793653, 0.48897016, 0.38780118, 0.64817471, -0.17018313, 0.036729203, -0.038715727, ],
[2, 1.65, 0.15995685, 1.6995491, 0.38051524, -0.25094344, 2.0540873, 0.0017620059, 3.7003014, -0.15400704, 0.49304181, 0.38920102, 0.6538755, -0.17426944, 0.037532195, -0.039499027, ],
[2, 1.667, 0.15959245, 1.7134927, 0.38092943, -0.25284024, 2.0707224, 0.0017293655, 3.6934624, -0.15604781, 0.49420116, 0.38980434, 0.65561346, -0.1756547, 0.037783791, -0.039743581, ],
[2, 1.7, 0.15881964, 1.7398709, 0.38153901, -0.25652876, 2.1021692, 0.0016689518, 3.6785756, -0.15997913, 0.49615741, 0.39113763, 0.65870966, -0.17834545, 0.038243904, -0.040189676, ],
[2, 1.8, 0.15604763, 1.8148722, 0.38222143, -0.26775417, 2.1917444, 0.001506903, 3.6226742, -0.17168205, 0.5000316, 0.39627483, 0.66599858, -0.1865821, 0.039440316, -0.041342217, ],
[2, 1.9, 0.1528045, 1.8836059, 0.38149634, -0.27904411, 2.2742242, 0.0013712389, 3.5545458, -0.1831294, 0.50141001, 0.40269392, 0.67103631, -0.19482113, 0.040393974, -0.042252054, ],
[2, 2, 0.14925306, 1.9471776, 0.37986149, -0.29039171, 2.3512831, 0.0012567336, 3.4779416, -0.19437851, 0.50086761, 0.41006533, 0.67425467, -0.20311327, 0.041158721, -0.042974906, ],
[2, 2.2, 0.14163595, 2.0618023, 0.37451367, -0.31324453, 2.4925424, 0.0010764345, 3.3090025, -0.2164352, 0.4955763, 0.42685697, 0.67710405, -0.21970102, 0.042269269, -0.044009345, ],
[2, 2.5, 0.12978428, 2.2092635, 0.36341005, -0.34789441, 2.6788035, 0.00089157069, 3.0372324, -0.24877755, 0.48071142, 0.45548242, 0.67537041, -0.24478234, 0.043237319, -0.044886598, ],
[2, 3, 0.11055004, 2.4054787, 0.34179936, -0.40663495, 2.9410003, 0.0007202227, 2.5808454, -0.30161774, 0.44558731, 0.50893787, 0.66456498, -0.28708537, 0.043827926, -0.045376369, ],
[2, 3.5, 0.092772635, 2.551696, 0.31914591, -0.46672578, 3.148402, 0.00064461156, 2.146195, -0.35398813, 0.40295223, 0.56748616, 0.65003439, -0.32995987, 0.043783984, -0.045277607, ],
[2, 4, 0.07653254, 2.6554192, 0.29657278, -0.52840794, 3.3050029, 0.00062328477, 1.7425461, -0.40656279, 0.35462092, 0.63044949, 0.6352101, -0.37319608, 0.043440943, -0.044911029, ],
[2, 4.5, 0.061652376, 2.7222082, 0.27396475, -0.59208139, 3.4103542, 0.00063791091, 1.3704474, -0.45992745, 0.30061695, 0.6980069, 0.62162609, -0.41663211, 0.042950365, -0.044419541, ],
[2, 5, 0.047910341, 2.7567969, 0.25076242, -0.65838426, 3.4694193, 0.00068138954, 1.0285974, -0.51472259, 0.24143548, 0.77110034, 0.61073091, -0.45960471, 0.042387029, -0.043872134, ],
[2, 5.5, 0.035092025, 2.7629053, 0.22607424, -0.72835023, 3.4874457, 0.00075333274, 0.71583369, -0.57178185, 0.18014581, 0.85189596, 0.60211877, -0.50255111, 0.041789615, -0.043296352, ],
[2, 6, 0.022994645, 2.7427844, 0.19769159, -0.8037874, 3.4668445, 0.00085914648, 0.43251569, -0.6323853, 0.12128122, 0.94506669, 0.59204751, -0.54920649, 0.041178619, -0.042691725, ],
[2, 6.5, 0.011405989, 2.6962759, 0.1601353, -0.88850875, 3.4104636, 0.0010126545, 0.18331545, -0.69898776, 0.066205506, 1.0619088, 0.58206332, -0.59934466, 0.040563723, -0.041378405, ],
];
    foreach my $item ( @{$rdata} ) {
        my ($symmetry, $gamma, @vars)=@{$item};
        $rpc_table->{$symmetry}->{$gamma} = [@vars];
    }
}

sub get_blast_info {

    # Given symmetry and gamma, return a hash of values if a table entry
    # exists; otherwise return nothing.
    my ( $symmetry, $gamma ) = @_;
    return unless $rpc_table->{$symmetry};
    my $rarray = $rpc_table->{$symmetry}->{$gamma};
    return unless $rarray;

    # Note that 'symmetry' and 'gamma' have been removed from values
    my @vals    = @{$rarray};
    my $nvals   = @{$rarray};
    my $nvnames = @vnames;
    if ( $nvals + 2 != $nvnames ) { croak "nvals=$nvals + 2 != $nvnames\n" }

    my $rhash;
    for ( my $i = 0 ; $i < $nvals ; $i++ ) {
        my $name = $vnames[ $i + 2 ];
        $rhash->{$name} = $rarray->[$i];
    }
    return $rhash;
}
1;
