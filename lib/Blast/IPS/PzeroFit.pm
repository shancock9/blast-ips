package Blast::IPS::PzeroFit;

# MIT License
# Copyright (c) 2018 Steven Hancock
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.

use strict;
use warnings;
use 5.006;

use Carp;
our $rpzero_fit;

#####################################
# Fits to zero overpressure line path
#####################################

BEGIN {

    # Created with: ./update_pzero_fit.pl
    # Wed May  9 08:02:05 2018   Inspiron-3668

    # Fit to Zero Pressure History
    # These fits to the zero-pressure time history have the form

    #   	z = zinf*( 1-k/[r**(N/2)-C+k] )

    # where zinf is the limiting z value (typically taken at about r=1.e6)

    # (t0, r0) = time and radial loction of first p=0
    # (t0_fit, r0_fit) = time and radial location that the fit begins
    # z_inf = limiting value of z=r-ct at long range
    # k, C = coeffients of the fit
    # max-err = maximum relative error in positive phase duration over the entire range of the fit
    # rp_match = a radius at which the fit is matched (has zero error)
    # err_match = max error beyond radius rp_match
    # rs_ovp1 shock radius when shock overpressure ratio = 1
    # err_ovp1 = relative error in fit to positive phase duration when shock overpressure ratio =1

    $rpzero_fit = [

        #Symmetry = 0
        [
            # [gamma, t0, r0, t0_fit, r0_fit, z_inf, k, C, max-err, rp_match, err_match, rs_ovp1, err_ovp1],
            [ 1.1,  0.239, 0.0435, 0.243, 0.0435, -0.199177, 0, 0, 0.0937, 0, 0.0875, 0.432, 0.0295, ],
            [ 1.12, 0.297, 0.0469, 0.295, 0.0469, -0.248283, 0, 0, 0.0819, 0, 0.076,  0.513, 0.0266, ],
            [ 1.15, 0.394, 0.055,  0.393, 0.055,  -0.338443, 0, 0, 0.0796, 0, 0.0731, 0.634, 0.0323, ],
            [ 1.17, 0.466, 0.0519, 0.455, 0.0519, -0.403289, 0, 0, 0.073,  0, 0.0667, 0.713, 0.0316, ],
            [ 1.2,  0.589, 0.0554, 0.579, 0.0554, -0.523275, 0, 0, 0.0751, 0, 0.0682, 0.832, 0.0394, ],
            [ 1.23, 0.734, 0.0548, 0.715, 0.0548, -0.660206, 0, 0, 0.0715, 0, 0.0647, 0.948, 0.0423, ],
            [ 1.25, 0.846, 0.0687, 0.842, 0.0687, -0.773501, 0, 0, 0.0754, 0, 0.0681, 1.03,  0.0494, ],
            [ 1.3,  1.2,   0.064,  1.19,  0.064,  -1.12177,  0, 0, 0.0767, 0, 0.0693, 1.22,  0.0604, ],
            [ 1.35, 1.72,  0.0873, 1.73,  0.0873, -1.64178,  0, 0, 0.0827, 0, 0.0751, 1.41,  0.0759, ],
            [ 1.4,  2.55,  0.0691, 2.54,  0.0691, -2.47273,  0, 0, 0.0909, 0, 0.0835, 1.6,   0.0936, ],
            [ 1.45, 4.02,  0.115,  5.04,  1.09,   -3.94822,  0, 0, 0.102,  0, 0.0951, 1.79,  0.11, ],
            [ 1.5,  7.05,  0.0806, 9.07,  2.09,   -6.983,    0, 0, 0.116,  0, 0.11,   1.98,  0.122, ],
            [ 1.55, 14.9,  0.194,  19.7,  4.9,    -14.8508,  0, 0, 0.132,  0, 0.128,  2.17,  0.136, ],
            [ 1.6,  47.4,  0.411,  65,    17.7,   -47.3467,  0, 0, 0.149,  0, 0.147,  2.35,  0.151, ],
        ],

        #Symmetry = 1
        [
            # [gamma, t0, r0, t0_fit, r0_fit, z_inf, k, C, max-err, rp_match, err_match, rs_ovp1, err_ovp1],
            [ 1.1,  0.116, 0.114, 0.111, 0.144, 0.0705641, 0.170698, 0.234581, 0.0497, 0.163, 0.0175, 0.352, 0.00495, ],
            [ 1.12, 0.125, 0.109, 0.12,  0.153, 0.0755746, 0.170705, 0.258782, 0.0498, 0.176, 0.0174, 0.384, 0.00477, ],
            [ 1.15, 0.136, 0.109, 0.132, 0.165, 0.0818918, 0.169376, 0.28994,  0.05,   0.193, 0.0168, 0.427, 0.00416, ],
            [ 1.17, 0.143, 0.0936, 0.139, 0.172, 0.0854374, 0.16786, 0.307947, 0.0498, 0.202, 0.0162, 0.453, 0.0036, ],
            [ 1.2, 0.151, 0.0945, 0.147, 0.179, 0.0900452, 0.165648, 0.331325, 0.0499, 0.216, 0.0151, 0.489, 0.00383, ],
            [
                1.23, 0.158, 0.0895, 0.154, 0.185, 0.0939174, 0.162992, 0.351572, 0.0498, 0.227, 0.0139, 0.522, 0.00428,
            ],
            [
                1.25, 0.163, 0.0976, 0.158, 0.187, 0.0962113, 0.161483, 0.363427, 0.0499, 0.234, 0.0131, 0.542, 0.00453,
            ],
            [ 1.3,  0.172, 0.0774, 0.166, 0.189, 0.101045, 0.157596, 0.38902,  0.05, 0.249, 0.0111,  0.591, 0.00498, ],
            [ 1.35, 0.179, 0.0825, 0.168, 0.17,  0.104968, 0.154434, 0.409745, 0.05, 0.262, 0.00926, 0.635, 0.00522, ],
            [ 1.4, 0.185, 0.0756, 0.202, 0.137, 0.108175, 0.151645, 0.426923, 0.0496, 0.273, 0.00755, 0.675, 0.00527, ],
            [ 1.45, 0.19, 0.0723, 0.209, 0.153, 0.110828, 0.149222, 0.441319, 0.0494, 0.282, 0.00602, 0.713, 0.00516, ],
            [
                1.49, 0.194, 0.0675, 0.214, 0.166, 0.112648, 0.147571, 0.451232, 0.0496, 0.288, 0.00498, 0.742, 0.00498,
            ],
            [ 1.5, 0.195, 0.0662, 0.215, 0.169, 0.113205, 0.147233, 0.453836, 0.0495, 0.29, 0.00492, 0.749, 0.00492, ],
            [
                1.51, 0.195, 0.0753, 0.216, 0.172, 0.113458, 0.146786, 0.455728, 0.0489, 0.291, 0.00485, 0.756, 0.00485,
            ],
            [
                1.55, 0.198, 0.0751, 0.221, 0.183, 0.114957, 0.145489, 0.463892, 0.0492, 0.296, 0.00458, 0.783, 0.00458,
            ],
            [ 1.6, 0.201, 0.0608, 0.227, 0.195, 0.116604, 0.144123, 0.472818, 0.0498, 0.301, 0.00419, 0.816, 0.00419, ],
            [ 1.65, 0.203, 0.0523, 0.233, 0.205, 0.118005, 0.142912, 0.480538, 0.05, 0.306, 0.00372, 0.847, 0.00372, ],
            [
                1.667, 0.204, 0.0438, 0.235, 0.208, 0.11845, 0.142599, 0.482907, 0.0499, 0.308, 0.00357, 0.857, 0.00357,
            ],
            [ 1.7, 0.205, 0.0552, 0.239, 0.214, 0.119208, 0.141843, 0.487253, 0.0498, 0.31,  0.00321, 0.877, 0.00321, ],
            [ 1.8, 0.208, 0.0529, 0.249, 0.228, 0.121199, 0.140294, 0.498163, 0.0499, 0.317, 0.00213, 0.934, 0.00213, ],
            [ 1.9, 0.21,  0.0333, 0.257, 0.238, 0.122765, 0.139348, 0.506455, 0.05,   0.321, 0.00266, 0.987, 0.00109, ],
            [ 2,   0.211, 0.033,  0.263, 0.246, 0.123943, 0.138568, 0.512852, 0.0499, 0.324, 0.0037,  1.04,  0.00103, ],
            [ 2.2, 0.212, 0.0384, 0.272, 0.255, 0.12557,  0.137886, 0.521263, 0.0498, 0.326, 0.00542, 1.13,  0.00363, ],
            [ 2.5, 0.211, 0.0346, 0.278, 0.259, 0.12685,  0.138108, 0.527013, 0.05,   0.324, 0.00764, 1.26,  0.00759, ],
            [ 3,   0.205, 0.0198, 0.278, 0.254, 0.127296, 0.140949, 0.526289, 0.0499, 0.311, 0.0141,  1.44,  0.0138, ],
            [ 3.5, 0.198, 0.0131, 0.272, 0.242, 0.126558, 0.145181, 0.519572, 0.0498, 0.295, 0.0201,  1.61,  0.0191, ],
            [ 4,   0.191, 0.015,  0.263, 0.228, 0.125175, 0.150202, 0.510275, 0.05,   0.277, 0.0255,  1.76,  0.0236, ],
            [ 4.5, 0.184, 0.0144, 0.253, 0.213, 0.123444, 0.15597,  0.499904, 0.0499, 0.259, 0.0305,  1.89,  0.0274, ],
            [ 5,   0.177, 0.00982, 0.244,  0.199, 0.121463, 0.16162, 0.489499, 0.0498, 0.243, 0.035, 2.02, 0.0305, ],
            [ 5.5, 0.171, 0.00268, 0.108,  0.227, 0.119305, 0,       0,        0.234,  0,     0.182, 2.14, 0.0156, ],
            [ 6,   0.165, 0.0102,  0.0954, 0.212, 0.117056, 0,       0,        0.234,  0,     0.176, 2.25, 0.0191, ],
            [ 6.5, 0.16,  0.0038,  0.0845, 0.199, 0.114736, 0,       0,        0.234,  0,     0.171, 2.36, 0.0223, ],
            [ 7,   0.155, 0.00793, 0.075,  0.187, 0.112359, 0,       0,        0.233,  0,     0.166, 2.46, 0.025, ],
        ],

        #Symmetry = 2
        [
            # [gamma, t0, r0, t0_fit, r0_fit, z_inf, k, C, max-err, rp_match, err_match, rs_ovp1, err_ovp1],
            [ 1.1, 0.128, 0.212, 0.124, 0.251, 0.189067, 0.0845201, 0.079092, 0.0498, 0.276, 0.0124, 0.445, 0.00362, ],
            [
                1.12, 0.134, 0.213, 0.131, 0.263, 0.198884, 0.0878435, 0.0892673, 0.0499, 0.292, 0.0124, 0.472, 0.00367,
            ],
            [ 1.15, 0.141, 0.213, 0.139, 0.277, 0.211123, 0.0917614, 0.102789, 0.0499, 0.312, 0.0121, 0.506, 0.00358, ],
            [ 1.17, 0.144, 0.196, 0.143, 0.285, 0.218082, 0.0939733, 0.110679, 0.0498, 0.323, 0.0119, 0.526, 0.00347, ],
            [ 1.2,  0.149, 0.198, 0.149, 0.294, 0.227141, 0.0966848, 0.121477, 0.0499, 0.338, 0.0115, 0.554, 0.00326, ],
            [ 1.23, 0.152, 0.176, 0.153, 0.302, 0.234937, 0.0989319, 0.131088, 0.0499, 0.35,  0.0111, 0.578, 0.0035, ],
            [ 1.25, 0.154, 0.171, 0.155, 0.306, 0.239567, 0.100208,  0.136944, 0.0499, 0.358, 0.0108, 0.593, 0.00363, ],
            [ 1.3,  0.157, 0.182, 0.16,  0.313, 0.24962,  0.102881,  0.149945, 0.0499, 0.374, 0.0101, 0.627, 0.00389, ],
            [ 1.35, 0.16,  0.168, 0.163, 0.317, 0.25799,  0.10495,  0.161125, 0.0499, 0.387, 0.00938, 0.658, 0.00409, ],
            [ 1.4,  0.161, 0.139, 0.164, 0.318, 0.265111, 0.106612, 0.17079,  0.05,   0.398, 0.00874, 0.685, 0.00425, ],
            [ 1.45, 0.162, 0.115, 0.164, 0.315, 0.271249, 0.107899, 0.179314, 0.05,   0.407, 0.00811, 0.71,  0.00434, ],
            [ 1.5,  0.162, 0.137, 0.162, 0.306, 0.276633, 0.108997, 0.186714, 0.05,   0.414, 0.00752, 0.733, 0.00441, ],
            [ 1.55, 0.162, 0.133, 0.178, 0.204, 0.281399, 0.109915, 0.193249, 0.0486, 0.421, 0.00696, 0.754, 0.00446, ],
            [ 1.6, 0.161, 0.0802, 0.178, 0.216, 0.285645, 0.110654, 0.19908, 0.049, 0.426, 0.00642, 0.775, 0.00448, ],
            [ 1.65,  0.16, 0.115, 0.178, 0.227, 0.28946,  0.11127, 0.204257, 0.0488, 0.43,  0.00589, 0.794, 0.00447, ],
            [ 1.667, 0.16, 0.109, 0.178, 0.23,  0.290679, 0.11148, 0.205854, 0.0498, 0.431, 0.00572, 0.8,   0.00448, ],
            [ 1.7, 0.159, 0.0905, 0.178, 0.237, 0.292912, 0.111794, 0.20885,  0.0499, 0.433, 0.00539, 0.812, 0.00445, ],
            [ 1.8, 0.156, 0.0975, 0.178, 0.256, 0.298946, 0.112698, 0.21648,  0.0498, 0.438, 0.00443, 0.845, 0.00438, ],
            [ 1.9, 0.153, 0.0845, 0.179, 0.273, 0.304028, 0.113394, 0.222461, 0.0498, 0.441, 0.00424, 0.876, 0.00424, ],
            [ 2,   0.149, 0.0256, 0.181, 0.286, 0.308379, 0.113986, 0.227043, 0.0499, 0.442, 0.00405, 0.904, 0.00405, ],
            [ 2.2, 0.142, 0.0654, 0.183, 0.306, 0.315462, 0.115117, 0.232751, 0.0499, 0.44,  0.00356, 0.955, 0.00356, ],
            [ 2.5, 0.13,  0.0597, 0.184, 0.319, 0.32329,  0.117008, 0.234852, 0.0499, 0.43,  0.00259, 1.02,  0.00259, ],
            [ 3, 0.111, 0.0292, 0.175, 0.315, 0.331872, 0.121701, 0.226331, 0.0499, 0.402, 0.00599, 1.11, 0.000876, ],
            [ 3.5, 0.0928, 0.029,   0.158, 0.292, 0.337175, 0.129352, 0.207093, 0.0499, 0.363, 0.0104, 1.19, 0.00444, ],
            [ 4,   0.0766, 0.0174,  0.136, 0.256, 0.340475, 0.141293, 0.179321, 0.0499, 0.315, 0.0155, 1.26, 0.00935, ],
            [ 4.5, 0.0617, 0.00791, 0.11,  0.207, 0.342405, 0.159583, 0.143966, 0.0499, 0.256, 0.0219, 1.32, 0.0159, ],
            [ 5,   0.0479, 0.0048,  0.082, 0.147, 0.343345, 0.186311, 0.103491, 0.0499, 0.189, 0.0305, 1.37, 0.0243, ],
            [ 5.5, 0.0351, 0.0064, 0.0569, 0.085, 0.343517, 0.21899, 0.0655187, 0.05, 0.122, 0.0441, 1.42, 0.0333, ],
            [ 6, 0.023, 0.00443, 0.0377, 0.0326, 0.343078, 0.250564, 0.0362949, 0.0499, 0.0683, 0.0561, 1.46, 0.0405, ],
            [
                6.5,    0.0114, 0.00125, 0.0195, 0.00125, 0.342124, 0.277242, 0.0152733,
                0.0353, 0.028,  0.0648,  1.5,    0.0454,
            ],
        ],
    ];
}
1;
